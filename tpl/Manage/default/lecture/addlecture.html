<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta content="{np::C('Keywords')}" name="Keywords">
    <meta content="{np::C('Description')}" name="Description">
    <link rel="stylesheet" type="text/css" href="{np::STATICS}/css/bootstrap_min.css" media="all"/>
    <link rel="stylesheet" type="text/css" href="{np::STATICS}/css/bootstrap_responsive_min.css" media="all"/>
    <link rel="stylesheet" type="text/css" href="{np::STATICS}/css/style.css" media="all"/>
    <link rel="stylesheet" type="text/css" href="{np::STATICS}/css/todc_bootstrap_button.css" media="all"/>
    <link rel="stylesheet" type="text/css" href="{np::STATICS}/css/themes.css" media="all"/>
    <link rel="stylesheet" type="text/css" href="{np::STATICS}/css/plugins/daterangepicker/daterangepicker.css"
          media="all"/>
    <link rel="stylesheet" type="text/css" href="{np::STATICS}/css/plugins/chosen/chosen.css" media="all"/>
    <link rel="stylesheet" type="text/css" href="{np::STATICS}/css/inside.css" media="all"/>
    <link rel="stylesheet" type="text/css" href="{np::STATICS}/css/resource.css" media="all"/>
    <script type="text/javascript" src="{np::STATICS}/src/jQuery.js"></script>
    <script type="text/javascript" src="{np::STATICS}/src/plugins/jquery-ui/jquery_ui_widget_min.js"></script>
    <script type="text/javascript" src="{np::STATICS}/src/bootstrap_min.js"></script>
    <script type="text/javascript" src="{np::STATICS}/src/plugins/form/jquery_form_min.js"></script>
    <script type="text/javascript" src="{np::STATICS}/src/plugins/validation/jquery_validate_min.js"></script>
    <script type="text/javascript" src="{np::STATICS}/src/plugins/validation/jquery_validate_methods.js"></script>
    <script type="text/javascript" src="{np::STATICS}/src/plugins/wizard/jquery_form_wizard_min.js"></script>
    <script type="text/javascript" src="{np::STATICS}/src/plugins/daterangepicker/moment_min.js"></script>
    <script type="text/javascript" src="{np::STATICS}/src/plugins/daterangepicker/daterangepicker.js"></script>
    <script type="text/javascript" src="{np::STATICS}/src/inside.js"></script>
    <script type="text/javascript" src="{np::STATICS}/src/map.js"></script>
    <title>{np::C('site_name')}—{np::C('site_title')}</title>
    <link rel="shortcut icon" href="{np::STATICS}/img/favicon.ico"/>
    <!--[if lte IE 9]>
    <script src="{np::STATICS}/src/watermark.js"></script><![endif]-->
    <!--[if IE 7]>
    <link href="{np::STATICS}/css/font_awesome_ie7.css" rel="stylesheet"/><![endif]-->
</head>
<body>
<script src="http://api.map.baidu.com/getscript?v=2.0&ak={np::C('baidu_map_api')}&services=true" type="text/javascript"
        type="text/javascript"></script>
<body>
<div id="main">
<div class="container-fluid">
<div class="row-fluid">
<div class="span12">
<div class="box">
    <div class="box-title">
        <div class="span10">
            <h3><i class="icon-edit"></i>微报名设置</h3>
        </div>
        <div class="span2"><a class="btn" href="Javascript:window.history.go(-1)">返回</a></div>
    </div>
    <div class="box-content">
        <form action="/npManage/Lecture/addLecture.act" method="post" class='form-horizontal form-validate'>
            <input type="hidden" name="id" id="id" value="{np:$info.id|default=''}"/>

            <div class="control-group">
                <label for="title" class="control-label">微报名标题：</label>

                <div class="controls">
                    <input type="text" name="title" id="title" class="input-xlarge"
                           value="{np:$info.title|default='微报名'}" data-rule-required="true"/><span
                        class="maroon">*</span>
                </div>
            </div>
            <div class="control-group">
                <label for="keyword" class="control-label">触发关键词：</label>

                <div class="controls">
                    <input type="text" name="keyword" id="keyword" class="input-xlarge"
                           value="{np:$info.keyword|default='微报名'}" data-rule-required="true"/><span
                        class="maroon">*</span><span class="help-inline">如有多个关键字请用空格隔开</span>
                </div>
            </div>
            <div class="control-group">
                <label for="info" class="control-label">图文消息标题：</label>

                <div class="controls">
                    <input type="text" name="info" id="info" class="input-xlarge" value="{np:$info.info|default='微报名'}" data-rule-required="true"/>
                    <span class="maroon">*</span>
                </div>
            </div>
            <div class="control-group">
                <label for="desc" class="control-label">图文消息简介：</label>

                <div class="controls">
                    <textarea class="input-xlarge" id="desc" name="desc" data-rule-maxlength="200" rows="5"
                              placeholder="显示在图文封面下方，文字请尽量的简洁">{np:$info.desc|default=''}</textarea>
                    <span class="help-inline">最多不超过200 个汉字</span>
                </div>
            </div>
            <div class="control-group">
                <label for="picurl" class="control-label">图文消息封面：</label>

                <div class="controls">
                    <img class="thumb_img" src="{np:$info.picurl|default=C('site_url').STATICS.'/img/head_pic.jpg'}"
                         style="max-height: 100px;">
                    <input id="picurl" type="hidden" name="picurl" class="input-xlarge" readonly=""
                           data-rule-required="true" data-rule-url="true"
                           value="{np:$info.picurl|default=C('site_url').STATICS.'/img/head_pic.jpg'}"/>
                    <span class="maroon">*</span>
					<span class="help-inline"><button class="btn select_img" type="button">选择封面</button></span>
                </div>
            </div>
            <div class="control-group">
                <label for="content" class="control-label">微报名介绍：</label>
                <div class="controls">
                    <textarea id="content" name="content" placeholder="微报名的介绍栏目" data-rule-required="true">{np:$info.content}</textarea>
                    <span class="maroon">*</span>
                </div>
            </div>
            <div class="control-group">
                <label for="schedule" class="control-label">行程安排：</label>
                <div class="controls">
                    <textarea id="schedule" name="schedule" placeholder="微报名的日程栏目">{np:$info.schedule}</textarea>
                </div>
            </div>
            <div class="control-group">
                <label for="present" class="control-label">与会嘉宾：</label>
                <div class="controls">
                    <textarea id="present" name="present" placeholder="微报名的嘉宾栏目">{np:$info.present}</textarea>
                </div>
            </div>
            <div class="control-group">
                <label for="address" class="control-label">活动地点：</label>

                <div class="controls">
                    <input type="text" name="address" id="address" class="input-xlarge"
                           value="{np:$info.address|default=''}" data-rule-required="true"
                           placeholder="请输入接待客户的地址"/><span class="maroon">*</span><span class="help-inline">如上海市杨浦区五角场万达广场</span>
                </div>
            </div>
            <div class="control-group" >
                <label for="activity_time" class="control-label">活动时间：</label>
                <div class="controls">
                    <div class="input-prepend">
                        <span class="add-on"><i class="icon-calendar"></i></span>
                        <input type="text" class="input-xlarge daterangepick" value="{np:$info.activity_time|default=date('Y/m/d H:i:s').' - '.date('Y/m/d H:i:s',time()+7200)}" name="activity_time" id="activity_time" />
                    </div>
                    <span class="help-inline">填写订单的起始和结束时间(为空表示不限制)</span>
                </div>
            </div>
            <div class="control-group">
                <label class="control-label" for="">地图标识</label>

                <div class="controls">
                    <div class="input-append">
                        <input type="text" id="suggestId" class="input-xlarge" name="place"
                               value="{np:$info.place|default=''}"/>
                        <button class="btn" type="button" id="positioning">搜索</button>
                    </div>

                    <span class="maroon">注意：这个只是模糊定位，准确位置请地图上标注!</span>

                    <div id="l-map">
                        <i class="icon-spinner icon-spin icon-large"></i>地图加载中...
                    </div>
                    <div id="r-result">
                        <input type="hidden" id="lng" name="lng" value="{np:$info.lng|default=''}"/>
                        <input type="hidden" id="lat" name="lat" value="{np:$info.lat|default=''}"/>
                    </div>

                </div>
            </div>
            <div class="control-group">
                <label for="tel" class="control-label">联系电话：</label>

                <div class="controls">
                    <input type="text" name="tel" id="tel" class="input-xlarge" value="{np:$info.tel|default=''}"
                           data-rule-required="true" placeholder="请输入主办方的电话号码"/><span class="maroon">*</span><span
                        class="help-inline">如021-61234567</span>
                </div>
            </div>
            <div class="control-group">
                <label for="recordpic" class="control-label">订单页头部图片：</label>

                <div class="controls">
                    <img class="thumb_img" src="{np:$info.recordpic|default=C('site_url').STATICS.'/img/head_pic.jpg'}" style="max-height: 100px;">
                    <input id="recordpic" type="hidden" name="recordpic" class="input-xlarge" readonly="" data-rule-required="true" data-rule-url="true"
                           value="{np:$info.recordpic|default=C('site_url').STATICS.'/img/head_pic.jpg'}"/>
                    <span class="maroon">*</span>
                    <span class="help-inline">
                        <button class="btn select_img" type="button">选择图片</button>
                    </span>
                </div>
            </div>
            <div class="control-group">
                <label for="recordinfo" class="control-label">订单详情：</label>
                <div class="controls">
                    <textarea class="input-xlarge" id="recordinfo" name="recordinfo" data-rule-required="true" data-rule-maxlength="200" rows="5"
                              placeholder="显示在订单页面，文字请尽量的简洁">{np:$info.info|default=''}</textarea>
                    <span class="maroon">*</span>
                    <span class="help-inline">最多不超过200 个汉字</span>
                </div>
            </div>
            <div class="control-group" style="display: none;">
                <label for="typename" class="control-label">订单接收设置：</label>
                <div class="controls">
                    <label class="radio inline">
                        <input type="radio" name="type" value="1" <empty name="info">checked</empty> <if condition="$info['type'] eq 1">checked="checked"</if> />
                        限定时间
                    </label>
                    <label class="radio inline">
                        <input type="radio" name="type" value="2" <if condition="$info['type'] eq 2">checked="checked"</if> />
                        限定每日量
                    </label>
                    <label class="radio inline">
                        <input type="radio" name="type" value="3" <if condition="$info['type'] eq 3">checked="checked"</if> />
                        限定全部总量
                    </label>
                    <span class="help-inline" id="type1" <if condition="$info['type'] neq 1 and $info neq false">style="display:none;"</if> >设定您接受订单的起始和结束时间</span>
                    <span class="help-inline" id="type2" <if condition="$info['type'] neq 2">style="display:none;"</if> >设定您每日接收的订单总数</span>
                    <span class="help-inline" id="type3" <if condition="$info['type'] neq 3">style="display:none;"</if> >设定您总计可接收的订单总数</span>
                </div>
            </div>

    <div class="control-group">
        <label for="date" class="control-label">限定时间</label>
        <div class="controls">
            <div class="input-prepend">
                <span class="add-on"><i class="icon-calendar"></i></span>
                <input type="text" class="input-xlarge daterangepick" value="<empty name='info'><?php echo date('Y/m/d H:i').' - '.date('Y/m/d H:i',time()+172800);?><else/>{np:$info.stime|date="Y/m/d H:i",###} - {np:$info.etime|date="Y/m/d H:i",###}</empty>" name="time" id="date" />
            </div>
            <span class="help-inline">填写订单的起始和结束时间(为空表示不限制)</span>
        </div>
    </div>
    <div class="control-group" >
    <label for="allnums" class="control-label">限定全部总量</label>

    <div class="controls">
        <input type="text" name="allnums" id="allnums" class="input-mini" value='{np:$info.allnums}' data-rule-number="true" />
        <span class="help-inline">填写最大接收订单数(为空表示不限制)</span>
    </div>
    </div>
<script type="text/javascript">
    $(function () {
        $("input[type='radio']").click(function () {
            var $this = $(this), $val = $this.val(), $div = $this.parents(".control-group");
            if ($val == 1) {
                $div.next().show();
                $div.next().next().hide();
                $("#type1").show();
                $("#type2").hide();
                $("#type3").hide();
            } else {
                $div.next().next().show();
                $div.next().hide();
                if ($val == 2) {
                    $("#type2").show();
                    $("#type1").hide();
                    $("#type3").hide();
                } else {
                    $("#type3").show();
                    $("#type1").hide();
                    $("#type2").hide();
                }
            }
        })
    })
</script>

<script>
    function dodelit(i) {


        document.getElementById("txt" + i).value = "";
        document.getElementById("value" + i).value = "";
        if (i != 1) {
            document.getElementById("trtxt" + i).style.display = "none";
            document.getElementById("add" + i).style.display = "";
        }
    }
    function doaddit(i) {

        document.getElementById('trtxt' + i).style.display = "";
        document.getElementById('add' + i).style.display = "none";


    }
    function sdodelit(i) {


        document.getElementById("select" + i).value = "";
        document.getElementById("svalue" + i).value = "";
        if (i != 1) {
            document.getElementById("strtxt" + i).style.display = "none";
            document.getElementById("sadd" + i).style.display = "";
        }
    }
    function sdoaddit(i) {

        document.getElementById('strtxt' + i).style.display = "";
        document.getElementById('sadd' + i).style.display = "none";


    }
</script>

<div class="control-group">
    <label for="tel" class="control-label">订单内容设置：</label>

    <div class="controls">
        <span class="help-inline">填写你要收集的内容！订单默认选项不可以修改删除！</span>
        <table id="listTable" class="table table-bordered table-hover dataTable">
            <thead>
            <tr>
                <th>字段类型</th>
                <th>字段名称</th>
                <th>初始内容</th>

                <th>操作</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td>单行文字：</td>
                <td>
                    <input name="keyword" type="text" disabled="disabled"
                           class="wizard-ignore" value="联系人"
                           readonly="readonly"></td>
                <td>
                    <input name="add[order][]" type="text"
                           disabled="disabled" class="wizard-ignore"
                           value="请输入您的名字" readonly="readonly"></td>

                <td>
                    <label class="checkbox">
                        <input type="checkbox" checked="checked"
                               name="name_show" value="1">是否显示
                    </label>
                </td>
            </tr>
            <tr>
                <td>单行文字：</td>
                <td>
                    <input name="keyword" type="text" disabled="disabled"
                           class="wizard-ignore" value="联系电话"
                           readonly="readonly"></td>
                <td>
                    <input name="add[order][]" type="text"
                           disabled="disabled" class="wizard-ignore"
                           value="请输入您的电话" readonly="readonly"></td>

                <td>
                    <label class="checkbox">
                        <input type="checkbox" checked="checked"
                               name="tel_show" value="1">是否显示
                    </label>
                </td>
            </tr>
            <tr>
                <td>单行文字：</td>
                <td>
                    <input name=" " type="text" disabled="disabled"
                           class="wizard-ignore" value="公司名称"
                           onchange="$('odid').value='请输入'+this.value;">
                </td>
                <td>
                    <input name="add[order][]" type="text"
                           disabled="disabled" id="odid"
                           class="wizard-ignore" value="请输入公司名称"></td>

                <td>
                    <label class="checkbox">
                        <input type="checkbox" checked="checked"
                               name="dept_show" value="1">是否显示
                    </label>
                </td>
            </tr>
            <tr>
                <td>单行文字：</td>
                <td>
                    <input name=" " type="text" disabled="disabled"
                           class="wizard-ignore" value="职位"
                           onchange="$('odid').value='请输入'+this.value;">
                </td>
                <td>
                    <input name="add[order][]" type="text"
                           disabled="disabled" id="odid"
                           class="wizard-ignore" value="请输入职位"></td>

                <td>
                    <label class="checkbox">
                        <input type="checkbox" checked="checked"
                               name="position_show" value="1">是否显示
                    </label>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="control-group" style="display: none;">
    <label for="" class="control-label">商家通知设置：</label>

    <div class="controls">
        <div class="row-fluid margin-bm10">
            订单通知邮箱：<input type="text" class="input-large" data-rule-email="true" name="email" value="{np:$info.email|default=''}">
            <span class="help-inline">
                <label class="checkbox inline">
                <input type="checkbox" name="open_email" value="1" <if condition="$info.open_email eq 1">checked="checked"</if> >
                开启
                </label>
            </span>
        </div>
        <p style="margin-left:83px;">当有新订单时，发送邮件到此邮箱</p>
    </div>
    <div class="controls">
        <div class="row-fluid">
            订单短信通知：<input type="text" class="input-large" data-rule-mobile="true" name="sms" value="{np:$info.sms|default=''}">
            <span class="help-inline">
                <label class="checkbox inline">
                <input type="checkbox" name="open_sms" value="1" <if condition="$info.open_sms eq 1">checked="checked"</if> >
                开启
                </label>
            </span>
        </div>
        <p style="margin-left:83px;">当有新订单时，发送短信到此手机</p>
    </div>
</div>
<div class="form-actions">

    <button id="bsubmit" type="submit" data-loading-text="提交中..." class="btn btn-primary">保存</button>
    <a class="btn" href="Javascript:window.history.go(-1)">取消</a>
</div>
</form>
</div>
<link href="{np::STATICS}/kindeditor/themes/default/default.css" rel="stylesheet"/>
<script src="{np::STATICS}/kindeditor/kindeditor-min.js"></script>
<script src="{np::STATICS}/kindeditor/lang/zh_CN.js"></script>
<script>
    var editor1;
    KindEditor.ready(function (K) {
        K.create("#content", G.set.KindEditor_seting);
        K.create("#schedule", G.set.KindEditor_seting);
        K.create("#present", G.set.KindEditor_seting);
        editor1 = K.editor({
            themeType: "simple",
            allowFileManager: true
        });
        K('button.select_img').click(function (e) {
            editor1.loadPlugin('smimage', function () {
                editor1.plugin.imageDialog({
                    imageUrl: $(e.target).parent().prevAll("input[type=hidden]").val(),
                    userRoot: '<?php echo substr(md5($_SESSION['uid']),16); ?>',
                    clickFn: function (url, title, width, height, border, align) {
                        var $input = $(e.target).parent().prevAll("input[type=hidden]")
                        $input.val(url)
                        $input.hide();
                        var t_img = $(e.target).parent().prevAll(".thumb_img:first");
                        if (t_img.length == 0) {
                            var tmp = '<img class="thumb_img" src="333" style="max-height: 100px;">';
                            $input.before(tmp.format(url))
                        } else {
                            t_img.attr("src", url);
                        }
                        $(e.target).text("重新选择")
                        editor1.hideDialog();
                    }
                });
            });

        });
    });


</script>
</div>
</div>
</div>
</div>
</div>
<script type="text/javascript">
    $(function () {
        var rid = $("#id").val();
        if (rid.length > 0) {
            var op = {
                lat: "{np:$info.lat}",
                lng: "{np:$info.lng}",
                adr: "{np:$info.place}"
            };
            baidu_map(op);
        } else {
            baidu_map();
        }
        baidu_map();
    });


    //添加单项文本
    $(".trtxt").each(function () {

        $(this).find('.btnGrayS').click(function () {
            var trtxt = $(this).parents(".trtxt");
            //读取当前单项文本的数量
            var num = $(".trtxt").size();
            if (num < 10) {
                newsingle = $(trtxt).clone(true);
                newsingle.appendTo(".singlebody");
                //清空文本
                $(newsingle).find('input').val('');
                hanghao("trtxt");
            } else {
                alert("最多能添加10项")
            }
        });

        //删除
        $(this).find('.trtxtdel').click(function () {
            var trtxt = $(this).parents(".trtxt");
            var num = $(".trtxt").size();
            if (num == 1) {
                //清空值
                $(trtxt).find('input').val('');
            } else {
                $(trtxt).remove();
                hanghao("trtxt");
            }
        });

    });


    //添加多项文本
    $(".strtxt").each(function () {

        $(this).find('.btnGrayS').click(function () {

            var trtxt = $(this).parents(".strtxt");
            //读取当前单项文本的数量
            var num = $(".strtxt").size();
            if (num < 10) {
                newsingle = $(trtxt).clone(true);
                newsingle.appendTo(".fielddownloadbody");
                //清空文本
                $(newsingle).find('input').val('');
                hanghao("strtxt");
            } else {
                alert("最多能添加10项")
            }
        });

        //删除
        $(this).find('.del').click(function () {
            var trtxt = $(this).parents(".strtxt");
            var num = $(".strtxt").size();
            if (num == 1) {
                //清空值
                $(trtxt).find('input').val('');
            } else {
                $(trtxt).remove();
                hanghao("strtxt");
            }
        });

    });


    //重新计算 行号
    function hanghao(type) {
        $("." + type).each(function (i) {
            $(this).find(".num" + type).html(i + 1);
        })
    }

</script>
</body>


</body>
</html>
