
<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="Keywords" content="{np::C('Keywords')}" />
    <meta name="Description" content="{np::C('Description')}" />
    <link rel="shortcut icon" href="{np::STATICS}/img/favicon.ico" />
    <link rel="stylesheet" type="text/css" href="{np::STATICS}/css/bootstrap_min.css" media="all" />
    <link rel="stylesheet" type="text/css" href="{np::STATICS}/css/bootstrap_responsive_min.css" media="all" />
    <link rel="stylesheet" type="text/css" href="{np::STATICS}/css/style.css" media="all" />
    <link rel="stylesheet" type="text/css" href="{np::STATICS}/css/todc_bootstrap.css" media="all" />
    <link rel="stylesheet" type="text/css" href="{np::STATICS}/css/themes.css" media="all" />
    <link rel="stylesheet" type="text/css" href="{np::STATICS}/css/inside.css" media="all" />
    <script type="text/javascript" src="{np::STATICS}/src/jQuery.js"></script>
    <script type="text/javascript" src="{np::STATICS}/src/bootstrap_min.js"></script>
    <script type="text/javascript" src="{np::STATICS}/src/inside.js"></script>
    <script type="text/javascript" src="{np::STATICS}/src/plugins/validation/jquery_validate_min.js"></script>
    <script type="text/javascript" src="{np::STATICS}/src/plugins/validation/jquery_validate_methods.js"></script>
    <script type="text/javascript" src="{np::STATICS}/src/plugins/form/jquery_form_min.js"></script>
    <title>{np::C('site_name')}—{np::C('site_title')}</title>
    <!--[if IE 7]>
    <link href="{np::STATICS}/css/font_awesome_ie7.css" rel="stylesheet" />
    <![endif]-->
    <!--[if lte IE 8]>
    <script src="{np::STATICS}/js/excanvas_min.js"></script>
    <![endif]-->
    <!--[if lte IE 9]>
    <script src="{np::STATICS}/js/watermark.js"></script>
    <![endif]-->
</head>
<script src="{np::STATICS}/kindeditor/kindeditor-min.js"></script>
<link href="{np::STATICS}/kindeditor/themes/default/default.css" rel="stylesheet" />
<script src="{np::STATICS}/kindeditor/kindeditor-min.js"></script>
<script src="{np::STATICS}/kindeditor/lang/zh_CN.js"></script>
<div id="main">
    <div class="container-fluid">

        <div class="row-fluid">
            <div class="span12">

                <div class="box">

                    <div class="box-title">
                        <div class="span10">
                            <h3><i class="icon-table"></i>积分攻略</h3>
                        </div>
                        <div class="span2">
                            <a class="btn" href="Javascript:window.history.go(-1)">返回</a>
                        </div>
                    </div>

                    <div class="box-content">
                        <ul class="nav nav-tabs">
                            <li class="active"><a href="#share" data-toggle="tab">积分攻略</a></li>
                            <li class=""><a href="#recommend" data-toggle="tab">每日推荐</a></li>
                        </ul>
                        <div class="tab-content">

                            <div class="tab-pane active" id="share">
                                <form action="/npManage/Member/setScores.act" method="post" class="form-horizontal form-validate">
                                    <div class="span12">
                                        <p class="help-inline">积分攻略</p>
                                        <br />
                                        <textarea id="info" name="score_content" data-rule-required="true" data-msg-required="积分攻略不能为空" data-rule-rangelength="[1,500]">{np:$info.score_content}</textarea>
                                    </div>
                                    <div class="span12"></div>
                                    <table class="table table-bordered table-hover  dataTable">
                                        <thead>
                                        <tr>
                                            <th>策略名称</th>
                                            <th>奖励积分(必须为整数)</th>

                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr>
                                            <td>每天签到奖励</td>
                                            <td>
                                                <input type="text" name="sign_score" id="sign_score" value="{np:$info.sign_score}" class="input-mini" data-rule-required="true" data-rule-digits="true" /></td>

                                        </tr>
                                        <tr>
                                            <td>连续<input type="text"  value="{np:$info.sign_days}" id="sign_days" name="sign_days" class="input-mini" data-rule-required="true" data-rule-digits="true"/> 天签到奖励</td>
                                            <td>
                                                <input type="text" name="sign_days_score" id="sign_days_score" value="{np:$info.sign_days_score}"" class="input-mini" data-rule-required="true" data-rule-digits="true"/></td>

                                        </tr>

                                        <tr>
                                            <td>分享奖励</td>
                                            <td>
                                                <input type="text" name="share_score" id="share_score" value="{np:$info.share_score}" class="input-mini" data-rule-required="true" data-rule-digits="true" /></td>

                                        </tr>
                                        <tr>
                                            <td>转发奖励</td>
                                            <td>
                                                <input type="text" name="post_score" id="post_score" value="{np:$info.post_score}" class="input-mini" data-rule-required="true" data-rule-digits="true" /></td>

                                        </tr>

                                        <!-- 奖励部分 -->
                                        <tr style="display: none;">
                                            <td>投票奖励：

                                                <select class="input-medium select_add_minu" name="vote_select[]" id="vote_select">
                                                    <option value="0">全部</option>
                                                </select>                                                        <a class="btn btn-mini add_tr hide"><i class="icon-plus"></i></a>
                                            </td>
                                            <td>
                                                <input type="text" name="vote_select_value[]" value="0" class="input-mini" data-rule-required="true" data-rule-digits="true" /></td>

                                        </tr>

                                        <tr style="display: none;">
                                            <td>调研奖励：

                                                <select class="input-medium select_add_minu" name="survey_select[]" id="survey_select">
                                                    <option value="0">全部</option>
                                                </select>                                                        <a class="btn btn-mini add_tr hide"><i class="icon-plus"></i></a>
                                            </td>
                                            <td>
                                                <input type="text" name="survey_select_value[]" value="0" class="input-mini" data-rule-required="true" data-rule-digits="true" /></td>

                                        </tr>
                                        <!-- 奖励部分 end-->
                                        </tbody>
                                    </table>

                                    <div>
                                        <input type="hidden" name="id" id="score_id" value="{np:$info.id}">
                                        <button type="submit" data-loading-text="提交中..." class="btn btn-primary">保存</button>
                                        <button type="button" class="btn" onclick="Javascript:window.history.go(-1);">取消</button>
                                    </div>
                                </form>
                            </div>
                            <div class="tab-pane  fade in fade " id="recommend">
                                <div class="row-fluid">
                                    <div class="control-group">
                                        <a href="/npManage/Member/addRecommend.act" class="btn"  ><i class="icon-plus"></i>添加每日推荐</a>
                                    </div>

                                </div>
                                <div class="row-fluid dataTables_wrapper">
                                    <table id="listTable" class="table table-bordered table-hover dataTable">

                                        <thead>
                                        <tr>
                                            <th>推荐名称</th>
                                            <th>显示顺序</th>
                                            <th>事件类型</th>
                                            <th>事件行为</th>
                                            <th>操作</th>
                                        </tr>
                                        </thead>



                                    </table>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

        </div>
    </div>
</div>

<script type="text/javascript">

    var s = $("select.select_add_minu"), a = $("a.add_tr");
    s.on("change", function () {
        var t = $(this), v = t.val(), b = (v != 0),aa=t.next();
        aa.toggle(b);
        if (!b) {
            console.log(t.parents("tr").nextAll("tr.add"));
            t.parents("tr").nextAll("tr.add").remove();
        }
    }),
            a.on("click", function () {
                var t = $(this), tr = t.parents("tr"), ss = $("select.select_add_minu"),
                        st = "select.select_add_minu option[value='{0}']";
                var c = $("<tr class='add'>{0}</tr>".format(tr.html()).replace("plus", "minus"));
                for (var i = 0; i < ss.length; i++) {
                    var vv = $(ss[i]).val();
                    $(st.format(vv), c).remove();
                };
                $(st.format(0), c).remove();
                var m = $("a.add", c).on("click", function () {
                    $(this).parents("tr").remove();
                });
                if ($("select.select_add_minu option", c).length > 0) {
                    tr.after(c);
                }

            });


    KindEditor.ready(function (K) {
        G.set.KindEditor_seting.height = "100px";
        K.create('#info', G.set.KindEditor_seting);
    });


</script>
<script>
    window.document.onkeydown = function(e) {
        if ('' == document.activeElement.id) {
            var e=e || event;
　 				var currKey=e.keyCode || e.which || e.charCode;
            if (8 == currKey) {
                return false;
            }
        }
    };
</script>
</html>