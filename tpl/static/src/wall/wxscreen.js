                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                !function (t) {
function e(t, e) {
        return t && t.length ? parseInt($.css(t[0], e)) || 0 : 0
    }
    function i(t) {
        return t && t.length ? t[0].offsetWidth + e(t, "marginLeft") + e(t, "marginRight") : 0
    }
    function r(t) {
        return t && t.length ? t[0].offsetHeight + e(t, "marginTop") + e(t, "marginBottom") : 0
    }
    if (!t.wxscreen) {
        var s = t.wxscreen = {
                _initialized : !1,
                _config : {},
                _state : "message"
            };
        s.DEBUG = !0;
        var n = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",
        o = 0,
        l = {},
        a = ["message", "messageDetail", "lottery", "ddp", "vote", "checkin"];
        s.init = function (t) {
            return this._config = $.extend({}, t),
            this._config.template && this._config.visibleNum && this._config.autoTime && this._config.stepTime && this._config.domain && this._config.siteUrl && this._config.companyId && this._config.timerColorMap || this.throwErr("in wxscreen.init config params is empty"),
            this._initialized = !0,
            this
        },
        s.getConf = function (t) {
            return this._initialized || this.throwErr("in func wxscreen.getConf wxscreen is not _initialized"),
            "string" == typeof t && t || this.throwErr("in func wxscreen.getConf name is empty or not string type"),
            "undefined" != typeof this._config[t] ? this._config[t] : (this.throwErr("in func wxscreen.getConf config[" + t + "] is not exists"), void 0)
        },
        s.setConf = function (t, e) {
            return "string" == typeof t && t || this.throwErr("in func wxscreen.getConf name is empty or not string type"),
            "undefined" == typeof this._config[t] && this.throwErr("in func wxscreen.getConf config[" + t + "] is not exists"),
            this._config[t] = e,
            this
        },
        s.isAdmin = function () {
            return this._initialized || this.throwErr("in func wxscreen.isAdmin wxscreen is not _initialized"),
            this._config.isAdmin
        },
        s.url = function (t) {
            this._initialized || this.throwErr("in func wxscreen.url wxscreen is not _initialized");
            var t = this._config.siteUrl + "/" + this._config.domain + "/" + t;
            sysConfig.urlSkin && (t = t.indexOf("?") > -1 ? t + "&skin=" + sysConfig.urlSkin : t + "?skin=" + sysConfig.urlSkin);
            var e = (new Date).getTime();
            return t.indexOf("?") > -1 ? t + "&r=" + e : t + "?r=" + e
        },
        s.registerState = function (e, i) {
            return -1 != this.inArray(e, a, !0) ? (t.throwErr("state has been registered: ", e), !1) : (a.push(e), this[e] = i, this)
        },
        s.getStateList = function () {
            return $.extend([], a)
        },
        s.getState = function () {
            return this._state
        },
        s.setState = function (t) {
            return -1 != this.inArray(t, a, !0) ? (this._state && this[this._state] && this[this._state].off && this[this._state].off(), this._state = t, this[this._state] && this[this._state].on && this[this._state].on(), "ddp" == this.getState() || "lottery" == this.getState() || "messageDetail" == this.getState() ? $(".scrollBox").css({
                        visibility : "hidden"
                    }) : $(".scrollBox").css({
                        visibility : "visible"
                    }), !0) : !1
        },
        s.fontNum = function (t) {
            if ("undefined" == typeof t)
                return 0;
            var e = t.match(/[^\x00-\x80]/g);
            return Math.ceil((t.length + (e ? e.length : 0)) / 2)
        },
        s.loop = function () {},
        s.showMsg = function (t) {
            alert(t)
        },
        s.randomStr = function (t) {
            if (isNaN(t))
                return "";
            for (var e = "", i = 0; t > i; i++) {
                var r = this.rand(0, 61);
                e += n.charAt(r)
            }
            return e
        },
        s.trim = function (t, e) {
            return e ? this.rtrim(this.ltrim(t, e), e) : t.replace(/(^\s*)|(\s*$)/g, "")
        },
        s.ltrim = function (t, e) {
            if (t = String(t), !e)
                return t.replace(/(^\s*)/g, "");
            e = String(e);
            var i = t.charAt(0);
            return -1 != e.indexOf(i) ? (t = t.substr(1), 0 == t.length ? t : this.ltrim(t, e)) : t
        },
        s.rtrim = function (t, e) {
            if (t = String(t), !e)
                return t.replace(/(\s*$)/g, "");
            e = String(e);
            var i = t.charAt(t.length - 1);
            return -1 != e.indexOf(i) ? (t = t.substr(0, t.length - 1), 0 == t.length ? t : this.rtrim(t, e)) : t
        },
        s.rand = function (t, e) {
            return Math.floor(Math.random() * (e - t + 1)) + t
        },
        s.isNull = function (t) {
            return t || "object" != typeof t ? !1 : !0
        },
        s.inArray = function (t, e, i) {
            if (e instanceof Array || this.throwErr("function wxs.inArray param two is not a Array type", "TypeError"), i && Array.prototype.indexOf)
                return e.indexOf(t);
            for (var r = 0; r < e.length; r++) {
                if (i && t === e[r])
                    return r;
                if (t == e[r])
                    return r
            }
            return -1
        },
        s.log = function () {
            return arguments.length ? (window.console && console.log && console.log.apply && (console.log("========= log start ========="), console.log.apply(console, Array.prototype.slice.call(arguments, 0, arguments.length)), console.log(" ")), void 0) : !1
        },
        s.throwErr = function (t, e) {
            ("string" != typeof t || e && "string" != typeof e) && (this.log("function wxs.throwErr params", t, e), this.throwErr("wxs.throwErr function error: params TypeError", "TypeError"));
            try {
                switch (e) {
                case "SyntaxError":
                    throw new SyntaxError(t);
                case "TypeError":
                    throw new TypeError(t);
                case "URIError":
                    throw new URIError(t);
                case "ReferenceError":
                    throw new ReferenceError(t);
                case "RangeError":
                    throw new RangeError(t);
                case "EvalError":
                    throw new EvalError(t);
                default:
                    throw new Error(t)
                }
            } catch (i) {
                throw window.console && console.trace && console.trace(),
                i
            }
        },
        s.preLoadAvatar = function (t) {
            this.loadImage(t)
        },
        s.loadImage = function (t, e, i) {
            if (t) {
                if ("undefined" == typeof i && (i = document.createElement("img")), i.src = t, i.complete)
                    return e && e(null, t, i), void 0;
                i.onload = function () {
                    i.onload = null,
                    e && e(null, t, i)
                },
                i.onerror = function () {
                    e && e("loadimage-error:" + t, null)
                }
            }
        },
        s.btnLoading = function (t, e) {
            "show" == e ? (t.attr("data-disabled", "yes"), t.children("span").hide().siblings("img").show()) : (t.attr("data-disabled", "no"), t.children("span").show().siblings("img").hide())
        },
        s.uniqueInsert = function (t, e, i) {
            return e instanceof Array || this.throwErr("wxscreen.uniqueInsert arr is not Array"),
            -1 != this.inArray(t, e) ? !1 : (i = i || "push", "push" == i ? (e.push(t), !0) : "unshift" == i ? (e.unshift(t), !0) : !1)
        },
        s.deleteByElem = function (t, e) {
            var i = this.inArray(t, e);
            return i >= 0 ? (e.splice(i, 1), !0) : !1
        },
        s.cid = function () {
            return ++o
        },
        s.counter = function (e, i) {
            "string" == typeof e && e || t.throwErr("wxs.counter name is not a string type or empty", e);
            var r = typeof i;
            return "undefined" == r ? ("undefined" == typeof l[e] && (l[e] = 0), ++l[e]) : (l[e] = 0, !0)
        },
        s.parseVisibleTime = function (t) {
            var e = this.getConf(t + "VisibleTime");
            if (!e)
                return this.DEBUG && this.log("wxs.parseVisibleTime error: ", t + "VisibleTime"), !1;
            if (e.latest_hour > 0) {
                var i = new Date;
                return [i.getTime() - 3600 * e.latest_hour * 1e3, Date.parse(this._generateDateStr("2099-01-01 00:00:00"))]
            }
            return e.start_time ? [Date.parse(this._generateDateStr(e.start_time)), Date.parse(this._generateDateStr(e.end_time))] : [0, Date.parse(this._generateDateStr("2099-01-01 00:00:00"))]
        },
        s._generateDateStr = function (t) {
            return t.replace(/\-/g, "/")
        },
        s.autoSizeTheme = function () {
            var t,
            e,
            i = this;
            return $.each($(".themeBox"), function () {
                    if (e = $(this), t = $.trim(e.html()), !t)
                        return !1;
                    if (t.indexOf("<br>") > -1 || t.indexOf("<br/>") > -1 || t.indexOf("<br />") > -1)
                        return !0;
                    if (!i.getConf("isV6"))
                        return !0;
                    var r = i.fontNum(t);
                    if (r > 14)
                        return !0;
                    var s = 338 / r;
                    s > 46 && (s = 46),
                    e.css({
                            "line-height" : "86px",
                            "font-size" : s + "px"
                        })
                }),
            !0
        },
        s.autoCenterLogo = function () {
            if (this.getConf("showCampusLogo"))
                return this.DEBUG && this.log("showCampusLogo true, ig."), !1;
            var t = $(".logoScreenLeft"),
            e = t.attr("src");
            this.loadImage(e, function (e, i, r) {
                    var s = r.width,
                    n = r.height,
                    o = n,
                    l = s,
                    a = 0,
                    d = 0;
                    o > 96 && (o = 96, l = s / n * 96),
                    l > 220 && (l = 220, o = n / s * 220),
                    220 > l && (a = (220 - l) / 2),
                    96 > o && (d = (96 - o) / 2),
                    t.css({
                            position : "relative",
                            width : l + "px",
                            height : o + "px",
                            left : a + "px",
                            top : d + "px"
                        })
                })
        },
        s.initNetworkState = function () {
            var t = null,
            e = this;
            this.sub("network.disconnected", function () {
                    e.getConf("isV6") && (t || (t = setInterval(function () {
                                        $(".btnNetwork").show().toggleClass("btn-wifi-disable")
                                    }, 200)))
                }),
            this.sub("network.ok", function () {
                    e.getConf("isV6") && t && (clearInterval(t), t = null, setTimeout(function () {
                                $(".btnNetwork").hide()
                            }, 210))
                }),
            window.onbeforeunload = function () {
                wxscreen.subLock(!0)
            }
        },
        s.hashTrigger = function () {
            $(function () {
                    var t = window.location.hash;
                    switch (t) {
                    case "#trigger_ddp":
                        $(".btnDdp").trigger("click");
                        break;
                    case "#trigger_lottery":
                        $(".btnLottery").trigger("click");
                        break;
                    case "#trigger_vote":
                        $(".btnVote").trigger("click");
                        break;
                    case "#trigger_skin_free_show":
                        $(".btnSkinSel").trigger("click"),
                        setTimeout(function () {
                                $(".skinNavList li[data-id='0']").trigger("click")
                            }, 200)
                    }
                })
        },
        s._css = function (t, i) {
            return e(t, i)
        },
        s._width = function (t) {
            return i(t)
        },
        s._height = function (t) {
            return r(t)
        }
    }
}
(window), function (t) {
    if (!t.template) {
        var e = t.template = {},
        i = {};
        e.getAll = function () {
            return $.extend({}, i)
        },
        e.add = function (e, r) {
            return e && "undefined" != typeof r || t.throwErr("template.add failed: param empty"),
            i[e] = r,
            this
        },
        e.get = function (t) {
            return i[t]
        }
    }
}
(wxscreen), function (t) {
    if ("undefined" != typeof t.indexedDB)
        return !1;
    var e = window.indexedDB || window.mozIndexedDB || window.webkitIndexedDB || window.msIndexedDB;
    return e ? (t.indexedDB = !0, void 0) : (t.DEBUG && t.log("indexedDB not support"), t.indexedDB = !1, !1)
}
(wxscreen), function (t) {
    function e(t) {
        for (var e = {}, i = 0; i < t.length; i++)
            e[t[i]] = null;
        return {
            channel : t,
            callback : [],
            data : e,
            fired : []
        }
    }
    function i(e) {
        return "string" != typeof e && t.throwErr("wxscreen.sub params error: channel is not a string type"),
        e = t.trim(t.trim(e), ","),
        e || t.throwErr("wxscreen.sub params error: channel is empty."),
        -1 != e.indexOf(",") && (e = e.replace(/\s+/g, "")),
        e
    }
    if (t.sub)
        return !1;
    var r = {},
    s = {},
    n = !1;
    t.pub = function (e, o) {
        if (e = i(e), n)
            return t.DEBUG && t.log("in g.pub eventBlocked"), !1;
        if (-1 != e.indexOf(","))
            for (var l = e.split(","), a = 0; a < l.length; a++)
                t.pub(l[a], o);
        else {
            if (r[e])
                for (var a = 0; a < r[e].length; a++)
                    isNaN(r[e][a].times) ? r[e][a].callback(e, o) : (r[e][a].times-- > 0 && r[e][a].callback(e, o), r[e][a].times <= 0 && (r[e].splice(a, 1), a--));
            for (var d in s)
                if (-1 != t.inArray(e, s[d].channel) && (t.uniqueInsert(e, s[d].fired), s[d].data[e] = o, s[d].channel.length == s[d].fired.length)) {
                    for (var h = 0; h < s[d].callback.length; h++)
                        isNaN(s[d].callback[h].times) ? s[d].callback[h].callback(s[d].channel, s[d].data) : (s[d].callback[h].times-- > 0 && s[d].callback[h].callback(s[d].channel, s[d].data), s[d].callback[h].times <= 0 && (s[d].callback.splice(h, 1), h--));
                    s[d].data = {},
                    s[d].fired = []
                }
        }
        return !0
    },
    t.sub = function (n, o, l) {
        if (n = i(n), -1 != n.indexOf(" ")) {
            var a,
            d;
            a = n.replace(/\s+/g, " ").split(" ").sort(),
            d = a.join(","),
            s[d] || (s[d] = e(a)),
            s[d].callback.push({
                    callback : o,
                    times : l
                })
        } else if (-1 != n.indexOf(","))
            for (var a = n.split(","), h = 0; h < a.length; h++)
                t.sub(a[h], o);
        else
            r[n] || (r[n] = []), r[n].push({
                    callback : o,
                    times : l
                });
        return !0
    },
    t.unSub = function (t, e) {
        if (t = i(t), -1 != t.indexOf(" ")) {
            var n = t.replace(/\s+/g, " ").split(" ").sort().join(",");
            if (s[n])
                if (e)
                    for (var o = 0; o < s[n].callback.length; o++)
                        s[n].callback[o].callback === e && (s[n].callback.splice(o, 1), o--);
                else
                    s[n] = void 0, delete s[n]
        } else if (r[t])
            if (e)
                for (var o = 0; o < r[t].length; o++)
                    r[t][o].callback === e && (r[t].splice(o, 1), o--);
            else
                r[t] = void 0, delete r[t];
        return !0
    },
    t.subOnce = function (t, e) {
        return this.sub(t, e, 1)
    },
    t.subLock = function (t) {
        return n = t ? !0 : !1,
        this
    },
    t._getSubscribeData = function () {
        return {
            _callbackList : r,
            _andCallbackList : s,
            _lock : n
        }
    }
}
(wxscreen), function (t) {
    function e(t) {
        var e = typeof t;
        return "string" != e && "number" != e ? !1 : t ? !0 : !1
    }
    if (!t.MemoryStorage) {
        t.MemoryStorage = function () {
            this.clear()
        };
        var i = t.MemoryStorage.prototype;
        i.setItem = function (t, i) {
            return e(t) ? (this._store[t] = i, !0) : !1
        },
        i.getItem = function (t) {
            return e(t) ? this._store[t] : null
        },
        i.removeItem = function (t) {
            return e(t) ? (delete this._store[t], !0) : !1
        },
        i.clear = function (t) {
            return t = t || {},
            this._store = t,
            !0
        }
    }
}
(wxscreen), function (t) {
    function e() {
        return !0
    }
    function i() {
        for (var t = [], e = 0; e < localStorage.length; e++)
            t.push(localStorage.key(e));
        return t
    }
    if (!t.Storage && (t.MemoryStorage || window.localStorage)) {
        var r = "undefined" != typeof t.MemoryStorage,
        s = {};
        t.Storage = function (e, i) {
            this._ns = this._defNs = "An",
            this._nsInitialized = !1,
            this._type = "memory" == e ? "memory" : "storage",
            this._isMemory = "memory" == this._type,
            "storage" != this._type || window.localStorage || (this._type = "memory", this._isMemory = !0),
            this._isMemory && !r && t.throwErr("wxscreen.MemoryStorage not initialized"),
            this._s = null,
            i && this.NS(i)
        };
        var n = t.Storage.prototype;
        n.NS = function (e) {
            return this._nsInitialized ? this : ("string" != typeof e && "number" != typeof e && t.throwErr("func s.NS param is not a string type", "TypeError"), e += "", -1 != e.indexOf(":") && t.throwErr('func s.NS param include char ":"', "SyntaxError"), e ? this._ns += ":" + e : this._ns = this._defNs, this._s = this._isMemory ? s[this._ns] ? s[this._ns] : s[this._ns] = new t.MemoryStorage : localStorage, this._nsInitialized = !0, this)
        },
        n._getNSList = function () {
            return s
        },
        n.set = function (e, i) {
            return this._nsInitialized || t.throwErr("sp.NS: NS failed ns not initialized"),
            "string" != typeof e && "number" != typeof e && t.throwErr("func s.set param is not a string type", "TypeError"),
            e += "",
            -1 != e.indexOf(":") && t.throwErr('func s.set param include char ":"', "SyntaxError"),
            e || t.throwErr("func s.set param key is empty", "TypeError"),
            this._isMemory || "object" != typeof i || (i = JSON.stringify(i)),
            this._isMemory || (e = this._ns + ":" + e),
            this._s.setItem(e, i),
            this
        },
        n.get = function (e) {
            ("string" != typeof e && "number" != typeof e || !e) && (t.log("sp.get key", e), t.throwErr("func s.get param is not a string type or is empty", "TypeError")),
            this._isMemory || (e = this._ns + ":" + e);
            var i = this._s.getItem(e);
            return this._isMemory || !i || "string" != typeof i || 0 != i.indexOf("{") && 0 != i.indexOf("[") || (i = JSON.parse(i)),
            i
        },
        n["delete"] = function (e) {
            return ("string" != typeof e && "number" != typeof e || !e) && t.throwErr("func s.set param is not a string type or is empty", "TypeError"),
            this._isMemory || (e = this._ns + ":" + e),
            this._s.removeItem(e),
            this
        },
        n.deleteNs = function (t) {
            if (this._isMemory)
                return this._s.clear(t), !0;
            for (var i = this.getNSKeys(), r = 0; r < i.length; r++)
                this._s.removeItem(i[r]), e(i[r]);
            return !0
        },
        n.getNSKeys = function () {
            if (this._isMemory)
                return !1;
            for (var t = i(), e = [], r = 0; r < t.length; r++)
                0 == t[r].indexOf(this._ns) && e.push(t[r]);
            return e
        }
    }
}
(wxscreen), function (t) {
    if (!t.LinkList) {
        t.Storage || t.throwErr("LinkList module depend on Storage module"),
        t.LinkList = function (i) {
            "object" != typeof i && t.throwErr("LinkList param is not a Object type", "TypeError"),
            this._storeType = e[i.storeType],
            ("undefined" == typeof this._storeType || this._storeType < 0) && t.throwErr("LinkList param storeType is undefined", "TypeError"),
            this._storeName = i.storeType,
            this._name = "string" == typeof i.name && i.name ? i.name : t.throwErr("LinkList param name is undefined", "TypeError"),
            this._unique = "string" == typeof i.unique && i.unique ? i.unique : null,
            1 == this._storeType && (this._storage = "memoryStorage" == this._storeName ? new t.Storage("memory", "l-" + this._name) : new t.Storage("storage", "l-" + this._name)),
            this._init_head(),
            this._init_length()
        };
        var e = {
            memory : 0,
            storage : 1,
            memoryStorage : 1
        },
        i = t.LinkList.prototype;
        i._init_head = function () {
            var t;
            return 0 == this._storeType ? t = this._generateElem("head") : 1 == this._storeType && (t = this._storage.get("headElem"), t || (t = this._generateElem("head"), this._storage.set("headElem", t))),
            this._head = t,
            t
        },
        i.checkUnique = function (t) {
            if (this._unique && t[this._unique]) {
                var e = {};
                e[this._unique] = t[this._unique];
                var i = this.search(e);
                if (i)
                    return !1
            }
            return !0
        },
        i.insertAfterIndex = function (e, i) {
            this.checkUnique(e) || t.throwErr("in lp.insertAfter unique check failed " + JSON.stringify(e));
            var r = this._generateElem(e);
            0 > i && t.throwErr("List insertAfter failed: index < 0", "Error");
            var s = this.length();
            i > s && t.throwErr("List insertAfter failed: index > List length", "Error");
            var n = !1,
            o = this.getElemByIndex(i),
            l = this.getElemByPointer(o.next);
            return r.prev = o.cid,
            r.next = l ? l.cid : "",
            l ? l.prev = r.cid : (this._head.prev = r.cid, n = !0),
            o.next = r.cid,
            n ? this._saveChanged(o, r, l, this._head) : this._saveChanged(o, r, l),
            this._lengthHandler(1),
            this.length()
        },
        i.push = function (t) {
            return this.insertAfterIndex(t, this.length())
        },
        i.unshift = function (t) {
            return this.insertAfterIndex(t, 0)
        },
        i.deleteByIndex = function (e) {
            (1 > e || e > this.length()) && t.throwErr("func lp.deleteByIndex param index is overflow.", "Error");
            var i = this.getElemByIndex(e),
            r = this.getElemByPointer(i.prev),
            s = this.getElemByPointer(i.next),
            n = !1;
            return s ? (r.next = s.cid, s.prev = r.cid) : (r.next = "", this._head.prev = r.cid, n = !0),
            n ? this._saveChanged(r, s, this._head) : this._saveChanged(r, s),
            this._remove(i),
            this._lengthHandler(-1),
            i
        },
        i.deleteByCid = function (t) {
            var e = this.getElemByPointer(t);
            if (!e)
                return !1;
            var i = this.getElemByPointer(e.prev),
            r = this.getElemByPointer(e.next),
            s = !1;
            return r ? (i.next = r.cid, r.prev = i.cid) : (i.next = "", this._head.prev = i.cid, s = !0),
            s ? this._saveChanged(i, r, this._head) : this._saveChanged(i, r),
            this._remove(e),
            this._lengthHandler(-1),
            e
        },
        i.pop = function () {
            var t = this.length();
            if (t > 0) {
                var e = this.deleteByIndex(t);
                if (e)
                    return e
            }
            return !1
        },
        i.shift = function () {
            var t = this.length();
            if (t > 0) {
                var e = this.deleteByIndex(1);
                if (e)
                    return e
            }
            return !1
        },
        i["delete"] = function (e, i) {
            if ("string" != typeof e && "number" != typeof e && t.throwErr("LinkList.delete param field is not a string,number type"), "string" != typeof i && "number" != typeof i && t.throwErr("LinkList.delete param val is not a string,number type"), this._unique && e == this._unique)
                return this.deleteByCid(i), 1;
            var r;
            e ? (r = {}, r[e] = i) : r = i;
            var s = this.search(r, !0);
            if (!s)
                return 0;
            if (!s.length)
                return this.deleteByCid(s.cid), 1;
            for (var n = 0; n < s.length; n++)
                this.deleteByCid(s[n].cid);
            return s.length
        },
        i.edit = function (t, e) {
            if ("stirng" == typeof t || "number" == typeof t) {
                if (i = this.getElemByPointer(t), !i)
                    return 0
            } else {
                var i = this.search(t, !0);
                if (!i)
                    return 0
            }
            i.length || (i = [i]);
            for (var r = 0, s = 0; s < i.length; s++) {
                var n = i[s].data;
                for (var o in e)
                    "undefined" != typeof n[o] && (n[o] = e[o]);
                i[s].data = n,
                this._saveChanged(i[s]),
                r++
            }
            return r
        },
        i.clear = function (t) {
            return 1 == this._storeType && this._storage.deleteNs(t),
            this._init_head(),
            this._init_length(),
            !0
        },
        i.search = function (t, e, i) {
            if (t && this._unique && t[this._unique]) {
                var r = this.getElemByPointer(t[this._unique]);
                return r ? e ? r : r.data : !1
            }
            for (var s, n, r = [], o = this.length(), l = typeof t, a = !isNaN(i), d = !1, h = 1; o >= h; h++) {
                s = this.getElemByIndex(h),
                n = typeof s.data;
                var u = e ? s : s.data;
                if ("undefined" == l) {
                    if (r.push(u), a && r.length >= i)
                        break
                } else if ("string" != n && "number" != n || "string" != l && "number" != l || t != s.data) {
                    if ("object" == n && "object" == l) {
                        d = !1;
                        for (var _ in t)
                            if ("undefined" != typeof s.data[_] && t[_] != s.data[_]) {
                                d = !0;
                                break
                            }
                        if (d === !1 && (r.push(u), a && r.length >= i))
                            break
                    }
                } else if (r.push(u), a && r.length >= i)
                    break
            }
            return 0 == r.length ? !1 : 1 == r.length ? r[0] : r
        },
        i.sort = function (e, i) {
            "string" == typeof e && e || t.throwErr("lp.sort param field is empty or TypeError", "TypeError"),
            i ? (i = i.toLowerCase(), "asc" != i && "desc" != i && t.throwErr("lp.sort param flag is not supported", "Error")) : i = "asc";
            var r = this.length();
            if (!r || 2 > r)
                return !0;
            if (!this._lock())
                return !1;
            try {
                for (var s = [], n = 1; r >= n; n++)
                    s.push(this.getElemByIndex(n));
                if (!s.length)
                    return this._unlock(), !0;
                ("object" != typeof s[0].data || "undefined" == typeof s[0].data[e]) && (this._unlock(), t.throwErr("lp.sort param " + e + " is not exists", "Error")),
                s.sort(function (t, r) {
                        return isNaN(t.data[e]) || (t.data[e] += ""),
                        isNaN(r.data[e]) || (r.data[e] += ""),
                        t.data[e] == r.data[e] ? 0 : "asc" == i ? t.data[e] < r.data[e] ? -1 : 1 : t.data[e] < r.data[e] ? 1 : -1
                    }),
                t.DEBUG,
                this._head.next = s[0].cid;
                for (var n = 1; n < s.length; n++)
                    s[n].next = s[n + 1] ? s[n + 1].cid : "", s[n].prev = s[n - 1].cid, this._saveChanged(s[n]);
                return this._saveChanged(s[0]),
                this._saveChanged(this._head),
                this._unlock(),
                !0
            } catch (o) {
                throw this._unlock(),
                o
            }
        },
        i._saveChanged = function () {
            if (arguments.length && 1 == this._storeType)
                for (var t = 0; t < arguments.length; t++)
                    arguments[t] && "undefined" != typeof arguments[t].cid && ("head" == arguments[t].data ? this._storage.set("headElem", arguments[t]) : this._storage.set(arguments[t].cid, arguments[t]));
            return !0
        },
        i._remove = function (t) {
            return t && "undefined" != typeof t.cid && 1 == this._storeType ? this._storage["delete"](t.cid) : !0
        },
        i._generateElem = function (t) {
            var e = {
                data : t,
                prev : "",
                next : ""
            };
            return e.cid = "head" == t ? 0 : this._getPointer(e),
            e
        },
        i._getPointer = function (e) {
            if (0 == this._storeType)
                return e;
            if (1 == this._storeType) {
                if (this._unique)
                    return e.data[this._unique] || t.throwErr("lp._getPointer elem has no unique id"), e.data[this._unique];
                var i = this._storage.get("cid");
                return i ? i++ : i = 1,
                this._storage.set("cid", i),
                i
            }
        },
        i.getElemByIndex = function (e) {
            if (0 == e)
                return this._head;
            if ((1 > e || e > this.length()) && t.throwErr("List insertAfter failed: index > List length or index < 1", "Error"), e == this.length())
                return this.getElemByPointer(this._head.prev);
            for (var i = this._head, r = 0; i.next; )
                if (i = this.getElemByPointer(i.next), r++, e == r)
                    return i;
            return !1
        },
        i.getDataByIndex = function (t) {
            var e = this.getElemByIndex(t);
            return e && "head" != e.data ? e.data : !1
        },
        i.getElemByPointer = function (t) {
            return 0 == this._storeType && t ? t : 1 == this._storeType ? 0 == t ? this._head : this._storage.get(t) : !1
        },
        i.length = function () {
            if (0 == this._storeType)
                return this._length;
            if (1 == this._storeType) {
                var t = this._storage.get("listLength");
                return isNaN(t) ? !1 : parseInt(t)
            }
        },
        i._lengthHandler = function (t) {
            if (0 == this._storeType)
                return this._length += t, this._length;
            if (1 == this._storeType) {
                var e = this.length();
                return e || (e = 0),
                e += t,
                this._storage.set("listLength", e),
                e
            }
        },
        i._init_length = function () {
            return 0 == this._storeType ? (this._length = 0, this._length) : 1 == this._storeType ? this._lengthHandler(0) : void 0
        },
        i._lock = function () {
            if (0 == this._storeType)
                return !0;
            var t = this._storage.get("listLock");
            return 1 == t ? !1 : (t || this._storage.set("listLock", 1), !0)
        },
        i._unlock = function () {
            return 0 == this._storeType ? !0 : (this._storage["delete"]("listLock"), !0)
        }
    }
}
(wxscreen), function (t) {
    function e(t, e, i, r) {
        a && (a.beginPath(), a.lineWidth = y, a.strokeStyle = r, a.arc(0, 0, t, e, i, !1), a.stroke())
    }
    function i(t) {
        l.innerHTML = t
    }
    if (!t.progress) {
        var r,
        s,
        n,
        o,
        l,
        a,
        d,
        h,
        u,
        _ = t.progress = {
                _timer : null,
                state : null
            },
        c = -Math.PI / 2,
        f = -Math.PI / 2,
        g = 2 * Math.PI,
        p = f + g,
        m = 18,
        y = 2,
        v = !1;
        _.step = function () {
            var n = Math.ceil((p - f) / g * s);
            return 0 == n ? t.pub("event.progress.compelete") : t.getConf("isV6") || i(n),
            p > f ? (e(m, f, f + h, u), f += h) : (a && a.clearRect(-30, -30, 60, 60), e(18, 0, 2 * Math.PI, r[1]), f = c),
            this
        },
        _.restart = function (e) {
            return this.stop().start(e),
            t.pub("progress.restarted"),
            this
        },
        _.start = function (t) {
            var e = this;
            return clearInterval(this._timer),
            this._timer = setInterval(function () {
                        e.step()
                    }, n),
            this.state = "running",
            t && t(),
            this
        },
        _.stop = function (t) {
            return clearInterval(this._timer),
            v || (a && a.translate(25, 25), v = !0),
            a && a.clearRect(-30, -30, 60, 60),
            e(18, 0, g, r[1]),
            f = c,
            this.state = "stoped",
            t && t(),
            this
        },
        _.pause = function (t) {
            return clearInterval(this._timer),
            this.state = "paused",
            t && t(),
            this
        },
        _.resume = function (t) {
            return this.start(t)
        },
        _.init = function () {
            return r = t.getConf("timerColorMap"),
            s = t.getConf("autoTime"),
            n = t.getConf("stepTime"),
            o = document.getElementById("cirProgress"),
            l = document.getElementById("remainTime"),
            a = o.getContext ? o.getContext("2d") : null,
            d = 1e3 * s,
            h = g / d * n,
            u = r[0],
            y = t.getConf("isV6") ? 2 : 5,
            this.stop(),
            this
        }
    }
}
(wxscreen), function (t) {
    if (!t.btnKeys) {
        var e = t.btnKeys = {},
        i = {
            13 : "key.enter.down",
            32 : "key.whitespace.down",
            37 : "key.left.down",
            38 : "key.up.down",
            39 : "key.right.down",
            40 : "key.down.down"
        };
        e.init = function () {
            return $ || t.throwErr("btnKeys depend on jQuery"),
            this.bindBtns().bindKeys(),
            this
        },
        e.bindBtns = function () {
            return t.sub("progress.restarted", function () {
                    setTimeout(function () {
                            var e = t.getConf("template");
                            "paused" == t.progress.state || "stoped" == t.progress.state ? "bo2" == e ? $(".btnPause").removeClass("btn-pause").addClass("btn-resume") : t.getConf("isV6") ? $(".btnPause").addClass("btn-pause") : $(".btnPause").text("启动") : "bo2" == e ? $(".btnPause").removeClass("btn-resume").addClass("btn-pause") : t.getConf("isV6") ? $(".btnPause").removeClass("btn-pause") : $(".btnPause").text("暂停")
                        }, 100)
                }),
            $(".btnFullScreen").click(function (e) {
                    e.preventDefault(),
                    e.stopPropagation();
                    var i = document.documentElement,
                    r = i.webkitRequestFullscreen || i.requestFullScreen || i.webkitRequestFullScreen || i.mozRequestFullScreen;
                    r && r.call(i),
                    t.pub("control.btn.btnFullScreen.clicked", e)
                }),
            $(".btnPause").click(function (e) {
                    var i = t.getConf("template");
                    "paused" == t.progress.state || "stoped" == t.progress.state ? (t.progress.resume(), "bo2" == i ? $(this).removeClass("btn-resume").addClass("btn-pause") : t.getConf("isV6") ? $(this).removeClass("btn-pause") : $(this).text("暂停")) : (t.progress.pause(), "bo2" == i ? $(this).removeClass("btn-pause").addClass("btn-resume") : t.getConf("isV6") ? $(this).addClass("btn-pause") : $(this).text("启动")),
                    t.pub("control.btn.btnPause.clicked", e)
                }),
            $(".btnNewest").click(function (e) {
                    t.pub("control.btn.btnNewest.clicked", e)
                }),
            $(".btnOldest").click(function (e) {
                    t.pub("control.btn.btnOldest.clicked", e)
                }),
            $(".btnPrev").click(function (e) {
                    t.pub("control.btn.btnPrev.clicked", e)
                }),
            $(".btnNext").click(function (e) {
                    t.pub("control.btn.btnNext.clicked", e)
                }),
            this
        },
        e.bindKeys = function () {
            $(document).on("keydown", function (e) {
                    var r = e.keyCode ? e.keyCode : e.which;
                    i.hasOwnProperty(r) ? t.pub(i[r], e) : t.pub("key." + r + ".down", e)
                })
        }
    }
}
(wxscreen), function (t) {
    if (!t.message) {
        t.LinkList || t.throwErr("module message depend on module LinkList"),
        t.progress || t.throwErr("module message depend on module progress"),
        jQuery || t.throwErr("module message depend on jQuery");
        var e = t.message = {
                _total : 0,
                _tag_id : 0,
                _tag_relation_ids : [],
                _linkList : null,
                _linkListPlayed : null,
                _tagLinkList : null,
                _storage : null,
                _lastId : 0,
                _tag_lastId : 0,
                _syncProgress : "stoped",
                _pullTimer : null,
                _ajaxObj : null,
                _progressTimer : null,
                _currentDomList : [],
                _currentList : [],
                _laterOffWallList : [],
                _scrollSpeed : 800,
                _scrollState : "stoped",
                _tmpProgressState : null,
                _scrollType : "next",
                _viewIds : [],
                _transitions : null,
                _dom_scrollBox : null,
                _dom_scrollBoxTextW : null,
                _dom_scrollBoxTextH : null,
                _dom_totalBox : null,
                _liHeight : null,
                _loadComplete : !1,
                _tag_loadComplete : !1,
                _isInLoading : !1,
                _isAutoScroll : null
            };
        e.init = function (e, i, r, s) {
            var n = this;
            this._tag_id = parseInt(s) || 0;
            var o = "memoryStorage";
            if (this._linkList = new t.LinkList({
                            name : "m-" + t.getConf("companyId"),
                            storeType : o,
                            unique : "id"
                        }), this._linkListPlayed = new t.LinkList({
                            name : "mp-" + t.getConf("companyId"),
                            storeType : o,
                            unique : "id"
                        }), this._tagLinkList = new t.LinkList({
                            name : "mtag-" + t.getConf("companyId"),
                            storeType : o,
                            unique : "id"
                        }), this._linkList.clear(), this._linkListPlayed.clear(), this._tagLinkList.clear(), this._storage = new t.Storage("storage", "msg-played-" + t.getConf("companyId")), this._transitions = function (t) {
                    var e = ["transformProperty", "WebkitTransform", "MozTransform", "OTransform", "msTransform"];
                    for (var i in e)
                        if (void 0 !== t.style[e[i]])
                            return !0;
                    return !1
                }
                (document.createElement("div")), this._dom_totalBox = $(".messageTotal"), this._dom_scrollBox = $("#container .scrollBox ul"), this._dom_scrollBox.css({
                        position : "relative"
                    }).parent().css({
                        visibility : "visible",
                        overflow : "hidden",
                        position : "relative"
                    }), this.bindEvent(), !this._dom_scrollBoxTextW) {
                var l = {
                    id : 0,
                    username : "&nbsp;",
                    avatar : "#",
                    photo_ori : "",
                    photo_small : "",
                    content : "&nbsp;"
                };
                this._dom_scrollBox.html(this.renderOne(l));
                var a = $(".displayContent").closest(".c-word");
                this._dom_scrollBoxTextW = a.width(),
                this._dom_scrollBoxTextH = a.height() - a.find(".msgUserName").height(),
                this._liHeight = t._height(this._dom_scrollBox.children("li:eq(0)")),
                this._transitions || this._dom_scrollBox.height(t.getConf("visibleNum") * this._liHeight),
                this._dom_scrollBox.html("")
            }
            return this.renderTotal(r),
            this.showLoading(0, r),
            this.add(i),
            t.setState("message"),
            t.progress.start(),
            this.pause(),
            t.subOnce("message.addCompleted", function () {
                    n._tag_id ? n._tag_loadComplete = !0 : n._loadComplete = !0,
                    n.updateLoading(n.length(), n.length()),
                    n.sort(),
                    n.initView(),
                    t.pub("message.loadComplete"),
                    t.DEBUG && t.log("subOnce: message.addCompleted"),
                    n.hideLoading()
                }),
            this
        },
        e.saveViewIds = function () {
            this._tag_id ? this._storage.set("tagViewIds", this._viewIds) : this._storage.set("viewIds", this._viewIds)
        },
        e.setViewIds = function (t) {
            var e = typeof t;
            ("string" == e || "number" == e) && (t = [t]);
            for (var i = 0; i < t.length; i++)
                t[i] = parseInt(t[i]);
            this._viewIds = t,
            this.saveViewIds()
        },
        e.initView = function () {
            var e = t.getConf("visibleNum");
            this._viewIds = this._tag_id ? this._storage.get("tagViewIds") || [] : this._storage.get("viewIds") || [];
            var i = this._tag_id ? this._tagLinkList : this._linkListPlayed,
            r = 0;
            if (this._viewIds && this._viewIds.length && i.length() > e) {
                for (var s = 0; s < this._viewIds.length; s++)
                    if (this.getElem(this._viewIds[s], i)) {
                        r = this._viewIds[s];
                        break
                    }
                0 == r && this.setViewIds([])
            }
            var n,
            o,
            l = [];
            if (i.length() < e)
                l = i.search(), 1 == i.length() && (l = [l]);
            else {
                for (0 != r && (n = this.getElem(r, i), n ? l.push(n.data) : (t.DEBUG && t.log("message.initView failed: pointer=", r), r = 0)), o = r; l.length < e && (n = this.getSublingElem(r, i, "next")); )
                    l.push(n.data), r = parseInt(n.data.id);
                if (l.length < e)
                    for (r = o; l.length < e && (n = this.getSublingElem(r, i, "prev")); )
                        l.unshift(n.data), r = parseInt(n.data.id)
            }
            for (var a = "", d = [], s = 0; s < l.length; s++)
                a += this.renderOne(l[s]), d.push(l[s].id);
            this.setViewIds(d),
            a && (this._dom_scrollBox.html(a), this.scrollFn(this._dom_scrollBox, 0, 0)),
            this.afterScrollEnd(),
            this.resume(),
            "running" == t.progress.state && t.progress.restart()
        },
        e.pullStop = function () {
            return clearTimeout(this._pullTimer),
            this._pullTimer = null,
            this._ajaxObj && this._ajaxObj.abort(),
            this._ajaxObj = null,
            this
        },
        e.pull = function () {
            var e = this;
            return this.pullStop(),
            this.sync(function (i) {
                    i && t.DEBUG && t.log("message.pull: sync return err:", i);
                    var r = e.length();
                    e._dom_scrollBox.children("li").length < t.getConf("visibleNum") && r && !e._isInLoading ? e.initView() : r || e._dom_scrollBox.html(""),
                    e._pullTimer = setTimeout(function () {
                                e.pull()
                            }, e._loadComplete ? 5e3 : 800)
                }),
            this
        },
        e.sync = function (e) {
            var i = location.hostname;
            if (-1 == i.indexOf("wxscreen.sinaapp.com") && -1 == i.indexOf("wxscreen.com") && -1 == i.indexOf("alltosun.net"))
                return window.location.reload(), void 0;
            if ("started" == this._syncProgress)
                return e("started");
            this._syncProgress = "started";
            var r,
            s = this._tag_id ? this._tag_lastId : this._lastId,
            n = this;
            return e = e || t.loop,
            r = {
                last_id : s,
                tag_id : this._tag_id,
                tag_relation_ids : this._tag_relation_ids
            },
            this._ajaxObj = $.post(t.url("message/sync"), r, function (i) {
                        t.pub("network.ok");
                        var r = null,
                        s = !1;
                        "ok" != i.info ? r = i.info : (n.renderTotal(i.all_total), i.message_list && n.add(i.message_list), i.off_wall_ids && n.offWall(i.off_wall_ids), 0 == i.all_total && (n._tag_id ? n._tagLinkList.clear() : (n._linkList.clear(), n._linkListPlayed.clear()), n.setViewIds([])), s = !0),
                        n._syncProgress = "stoped",
                        e(r, s)
                    }, "json").error(function (i, r, s) {
                        t.DEBUG && t.log("message.sync ajax-error: jqXHR, textStatus, errorThrown ", i, r, s),
                        n._syncProgress = "stoped",
                        i.readyState < 2 && "error" == r && t.pub("network.disconnected", i),
                        e("ajax-error:" + r)
                    }),
            this
        },
        e.add = function (i) {
            if (!i || !i.length)
                return e.updateLoading(), t.pub("message.addCompleted"), !1;
            this._tag_id ? this._tag_lastId = i[i.length - 1].tag_relation_id : this._lastId = i[i.length - 1].update_time_ms;
            for (var r = 0; r < i.length; r++) {
                t.preLoadAvatar(i[r].avatar),
                i[r].photo_small && t.loadImage(i[r].photo_small);
                var s;
                this._tag_id ? (s = this.getElem(i[r].id, this._tagLinkList), s ? s.data.update_time_ms < i[r].update_time_ms ? (this._tagLinkList["delete"]("id", i[r].id), this._tagLinkList.push(i[r])) : this._tagLinkList.edit({
                            id : i[r].id
                        }, i[r]) : this._tagLinkList.push(i[r])) : 2 == i[r].is_on_wall ? (s = this.getElem(i[r].id, this._linkList), s ? s.data.update_time_ms < i[r].update_time_ms ? (this._linkList["delete"]("id", i[r].id), this._linkList.push(i[r])) : this._linkList.edit({
                            id : i[r].id
                        }, i[r]) : this._linkList.unshift(i[r])) : (s = this.getElem(i[r].id, this._linkListPlayed), s ? s.data.update_time_ms < i[r].update_time_ms ? (this._linkListPlayed["delete"]("id", i[r].id), this._linkListPlayed.push(i[r])) : this._linkListPlayed.edit({
                            id : i[r].id
                        }, i[r]) : this._linkListPlayed.push(i[r])),
                this._tag_id && i[r].tag_relation_id && t.uniqueInsert(i[r].tag_relation_id, this._tag_relation_ids),
                e.updateLoading()
            }
            return i.length < 100 ? (e.updateLoading(), t.pub("message.addCompleted"), this) : (e.updateLoading(), this)
        },
        e.addToPlayed = function (t) {
            if (!t.length)
                return !1;
            for (var e = 0; e < t.length; e++) {
                var i = this.info(t[e]);
                if (i) {
                    this._linkList["delete"]("id", t[e]);
                    for (var r = 0; r < this._currentList.length; r++)
                        this._currentList[r].data.id == t[e] && (this._currentList.splice(r, 1), r--);
                    this._tag_id ? this.getElem(t[e], this._tagLinkList) || this._tagLinkList.push(i) : this.getElem(t[e], this._linkListPlayed) || this._linkListPlayed.push(i)
                }
            }
        },
        e.showLoading = function (t, e) {
            this._isInLoading = !0,
            e = "undefined" == typeof e ? this.length() : e,
            t = "undefined" == typeof t ? this.nowLength() : t;
            var i = Math.ceil(t / e * 100);
            $(".messageLoading .messageLoadProgress").text(t + "/" + e),
            $(".messageLoading .messageLoadBar").css({
                    width : i + "%"
                }),
            $(".messageLoading").show()
        },
        e.updateLoading = function (t, e) {
            e = "undefined" == typeof e ? this.length() : e,
            t = "undefined" == typeof t ? this.nowLength() : t;
            var i = Math.ceil(t / e * 100);
            $(".messageLoading .messageLoadProgress").text(t + "/" + e),
            $(".messageLoading .messageLoadBar").css({
                    width : i + "%"
                })
        },
        e.hideLoading = function (t) {
            var e = this;
            setTimeout(function () {
                    $(".messageLoading").hide(),
                    e._isInLoading = !1,
                    t && t()
                }, 200)
        },
        e.offWall = function (e) {
            if (!e || !e.length)
                return !1;
            for (var i = t.getConf("visibleNum"), r = 0; r < e.length; r++) {
                if (t.deleteByElem(e[r], this._tag_relation_ids), -1 != t.inArray(e[r], this._currentDomList) || e[r] == t.messageDetail._currentId || -1 != t.inArray(e[r], this._viewIds)) {
                    if (this.length() > i) {
                        this._laterOffWallList.push(e[r]);
                        continue
                    }
                    try {
                        this._dom_scrollBox.find('li[data-id="' + e[r] + '"]').remove(),
                        "messageDetail" == t.getState() && t.messageDetail.hide()
                    } catch (s) {}
                    
                }
                if (this._linkList["delete"]("id", e[r]), this._linkListPlayed["delete"]("id", e[r]), this._tagLinkList["delete"]("id", e[r]), this._currentList.length)
                    for (var n = 0; n < this._currentList.length; n++)
                        this._currentList[n].data.id == e[r] && (this._currentList.splice(n, 1), n--)
            }
            return !0
        },
        e.newest = function (e) {
            e = e || 1;
            var i,
            r = [];
            e > this.length() && (e = this.length());
            var s = this._tag_id ? this._tagLinkList : this._linkListPlayed,
            n = this._linkList.search();
            if (n.length) {
                for (var o = [], l = 0; l < n.length; l++)
                    o.push(parseInt(n[l].id));
                this.addToPlayed(o)
            }
            var a = 0,
            d = this.getSublingElem(a, s, "prev");
            if (d && d.data.id == this._viewIds[this._viewIds.length - 1])
                return t.DEBUG && t.log("lastElem.data.id == this._viewIds[this._viewIds.length -1]"), this.noticeScrollEnd(), !1;
            for (; r.length < e && (i = this.getSublingElem(a, s, "prev")); )
                r.unshift(i), a = parseInt(i.data.id);
            if (!r.length)
                return t.DEBUG && t.log("message.newest: list.length = 0"), !1;
            for (var o = [], l = 0; l < r.length; l++)
                o.push(r[l].data.id);
            return this.setViewIds(o.slice(-t.getConf("visibleNum"))),
            1 == e ? r[0] : r
        },
        e.oldest = function (e) {
            e = e || 1;
            var i,
            r = [];
            e > this.length() && (e = this.length());
            var s = this._tag_id ? this._tagLinkList : this._linkListPlayed,
            n = 0,
            o = this.getSublingElem(n, s, "next");
            if (o && o.data.id == this._viewIds[0])
                return t.DEBUG && t.log("firstElem.data.id == this._viewIds[0]"), this.noticeScrollEnd(), !1;
            for (; r.length < e && (i = this.getSublingElem(n, s, "next")); )
                r.push(i), n = parseInt(i.data.id);
            if (!r.length)
                return t.DEBUG && t.log("message.oldest list.length = 0"), !1;
            for (var l = [], a = 0; a < r.length; a++)
                l.push(r[a].data.id);
            return this.setViewIds(l.slice(0, t.getConf("visibleNum"))),
            1 == e ? r[0] : r
        },
        e.next = function (e) {
            e = e || 1;
            var i,
            r,
            s = [];
            e > this.length() && (e = this.length());
            for (var n = this._tag_id ? this._tagLinkList : this._linkListPlayed; s.length < e && (i = this._linkList.shift()); )
                s.push(i);
            this._currentList = this._currentList.concat(s);
            var o = 0;
            if (this._viewIds.length > 0 && (o = this._viewIds[this._viewIds.length - 1]), elemPointer = this.getElem(o, n), 0 == o || elemPointer) {
                for (; s.length < e && (r = this.getSublingElem(o, n, "next")); )
                    s.push(r), o = parseInt(r.data.id);
                if (t.getConf("isCycleScroll") && s.length < e)
                    for (o = 0; s.length < e && (r = this.getSublingElem(o, n, "next")); )
                        s.push(r), o = parseInt(r.data.id)
            } else if (t.DEBUG)
                return t.DEBUG && t.log("message.prev elemPointer is null"), !1;
            if (!s.length)
                return t.DEBUG && t.log("message.prev list.length = 0"), this.noticeScrollEnd(), !1;
            for (var l = [], a = 0; a < s.length; a++)
                l.push(s[a].data.id);
            if (this.setViewIds(l), this._currentList.length) {
                l = [];
                for (var a = 0; a < this._currentList.length; a++)
                    l.push(this._currentList[a].data.id);
                this.addToPlayed(l)
            }
            return 1 == e ? s[0] : s
        },
        e.prev = function (e) {
            e = e || 1;
            var i,
            r,
            s,
            n = [];
            e > this.length() && (e = this.length());
            var o = this._tag_id ? this._tagLinkList : this._linkListPlayed,
            l = 0;
            if (this._viewIds.length > 0 && (l = this._viewIds[0]), r = this.getElem(l, o), 0 == l || r) {
                for (s = r; n.length < e && (i = this.getSublingElem(l, o, "prev")); )
                    n.unshift(i), s = i, l = parseInt(s.data.id);
                if (t.getConf("isCycleScroll") && n.length < e)
                    for (l = 0; n.length < e && (i = this.getSublingElem(l, o, "prev")); )
                        n.unshift(i), l = parseInt(i.data.id)
            } else if (t.DEBUG)
                return t.DEBUG && t.log("message.prev elemPointer is null"), !1;
            if (!n.length)
                return t.DEBUG && t.log("message.prev list.length = 0"), this.noticeScrollEnd(), !1;
            for (var a = [], d = 0; d < n.length; d++)
                a.push(n[d].data.id);
            return this.setViewIds(a),
            1 == e ? n[0] : n
        },
        e.indexOf = function (t) {
            return this._linkList.getDataByIndex(t)
        },
        e.info = function (t) {
            if (!t || isNaN(t))
                return !1;
            var e = this.getElem(t, this._linkList);
            if (e || (e = this.getElem(t, this._linkListPlayed)), e || (e = this.getElem(t, this._tagLinkList)), !e)
                for (var i = 0; i < this._currentList.length; i++)
                    if (this._currentList[i].data.id == t) {
                        e = this._currentList[i];
                        break
                    }
            return e ? e.data : !1
        },
        e.getElem = function (t, e) {
            var i = e.getElemByPointer(t);
            return i && "head" != i.data ? i : !1
        },
        e.getSublingElem = function (e, i, r) {
            e = parseInt(e),
            r = r || "next",
            r = r.toLowerCase();
            var s = i.getElemByPointer(e);
            if (!s)
                return t.DEBUG && t.log("message.getPrevElem failed: no elem exists", e), !1;
            var n = s[r];
            return n ? this.getElem(n, i) : (t.DEBUG && t.log("message.getPrevElem failed: no sublingId is empty."), !1)
        },
        e.length = function () {
            return this._total
        },
        e.nowLength = function () {
            return this._tag_id ? this._tagLinkList.length() : this._linkListPlayed.length() + this._linkList.length() + this._currentList.length
        },
        e.sort = function () {
            return this._linkList.sort("update_time_ms", "asc"),
            this._linkListPlayed.sort("update_time_ms", "asc"),
            this._tagLinkList.sort("update_time_ms", "asc"),
            this
        },
        e.renderTotal = function (e) {
            isNaN(e) || (this._total = parseInt(e)),
            e = e || this.length();
            var i = t.getState();
            return "checkin" != i && this._dom_totalBox.text(e),
            this
        },
        e.renderList = function (t) {
            if (!t.length)
                return "";
            for (var e = "", i = 0; i < t.length; i++)
                e += this.renderOne(t[i]);
            return e
        },
        e.renderOne = function (e) {
            if (!e)
                return "";
            var i = !!e.photo_small,
            r = t.getConf("visibleNum"),
            s = this.getFontSize(e.content, r),
            n = r >= 3 ? 'style="max-width:158px;max-height:112px;display:block;"' : 'style="max-width:600px;max-height:160px;display:block;"',
            o = "",
            l = "";
            if (i ? l = "<img " + (r >= 3 ? 'class="with-map msgImage"' : 'class="msgImage"') + ' src="' + e.photo_small + '" ' + n + " />" : o = '<span class="cont displayContent" style="font-size:' + s + 'px;">' + e.content + "</span>", i && r >= 3 ? e.content = "分享一张照片：" : i && (e.content = l), e.user_id > 0) {
                var a = t.user.info(e.user_id);
                a && (e.avatar = a.avatar)
            }
            return html = '      <li class="clearfix ' + (r >= 3 ? "t-row" : "") + '" data-id="' + e.id + '" data-update_time_ms="' + e.update_time_ms + '" style="display:block;">    <div class="userimg left">          <i class="elem"></i>      <span class="elem2"></span>      <a href="javascript:void(0);" class="head"><img class="msgAvatar" src="' + e.avatar + '" width="90" height="90" alt=""></a>    </div>        <div class="cont-box left">          <p class="c-word">            <a href="javascript:void(0);" class="user-name msgUserName">' + e.username + ":</a>            " + (i && 2 == r ? l : o) + "          </p>          " + (r >= 3 && i ? l : "") + '        </div>        <div class="btn-detail messageDetailBtn" >          <div class="btn-style">            <a href="javascript:void(0);" class="icon-arrow"></a>          </div>        </div>      </li>'
        },
        e.renderLi = function (t, e) {
            return t.after(this.renderOne(e)).remove(),
            this
        },
        e.getFontSize = function (e, i) {
            e = t.trim(e),
            -1 != e.indexOf("<img") && (e = e.replace(/\<img.+?\>/g, "") ? e.replace(/\<img.+?\>/g, "11") : ""),
            -1 != e.indexOf("<span") && -1 != e.indexOf("emoji") && (e = e.replace(/<span.+?emoji.+?><\/span>/g, "") ? e.replace(/<span.+?emoji.+?><\/span>/g, "11") : "");
            var r = t.fontNum(e);
            if (!r || !this._dom_scrollBoxTextW)
                return 16;
            var s = i >= 3 ? 55 : 120,
            n = Math.sqrt(this._dom_scrollBoxTextW * this._dom_scrollBoxTextH / r) / 1.6;
            return n > s && (n = s),
            n
        },
        e.setScrollType = function (t, e) {
            this._scrollType = t,
            this._isAutoScroll = e ? !0 : !1
        },
        e.noticeScrollEnd = function () {
            if (this._isAutoScroll)
                return t.DEBUG && t.log("message.noticeScrollEnd: this._isAutoScroll true"), void 0;
            var e = this._scrollType;
            switch (e) {
            case "next":
                $(".btnNext").tooltipster("content", "暂无新消息上墙").tooltipster("show"),
                setTimeout(function () {
                        $(".btnNext").tooltipster("hide").tooltipster("content", "下一屏（快捷键“↓”）")
                    }, 1500);
                break;
            case "prev":
                $(".btnPrev").tooltipster("content", "已经滚动到最旧消息").tooltipster("show"),
                setTimeout(function () {
                        $(".btnPrev").tooltipster("hide").tooltipster("content", "上一屏（快捷键“↑”）")
                    }, 1500);
                break;
            case "newest":
                $(".btnNewest").tooltipster("content", "已经滚动到最新消息").tooltipster("show"),
                setTimeout(function () {
                        $(".btnNewest").tooltipster("hide").tooltipster("content", "最新一屏（快捷键“→”）")
                    }, 1500);
                break;
            case "oldest":
                $(".btnOldest").tooltipster("content", "已经滚动到最旧消息").tooltipster("show"),
                setTimeout(function () {
                        $(".btnOldest").tooltipster("hide").tooltipster("content", "最旧一屏（快捷键“←”）")
                    }, 1500)
            }
        },
        e.getScrollType = function () {
            return this._scrollType
        },
        e.scrollCheck = function () {
            return "running" == this._scrollState ? (t.DEBUG && t.log("message.scrollCheck is running"), !1) : this._currentDomList.length ? this.length() > t.getConf("visibleNum") ? !0 : (0 == this.length() && this._dom_scrollBox.html(""), t.DEBUG && t.log("message.scrollCheck message.length <= visibleNum"), !1) : (t.DEBUG && t.log("message.scrollCheck _currentDomList.length == 0"), !1)
        },
        e.renderScroll = function (e, i) {
            var r = Math.abs(this._dom_scrollBox.attr("data-to") || 0) / this._liHeight,
            s = this._dom_scrollBox.children("li:eq(" + r + ")"),
            n = r + this._currentDomList.length - 1,
            o = this._dom_scrollBox.children("li:eq(" + n + ")");
            s && o && s.length && o.length || t.throwErr("message.renderScroll firstLi or lastLi not exists");
            for (var l = "", a = [], d = 0; d < e.length; d++)
                e[d].data || (e[d].data = e[d]), a.push(e[d].data.id), l += this.renderOne(e[d].data);
            if (!l)
                return t.DEBUG && t.log("message.renderScroll failed: html is empty. isCycleScroll:", t.getConf("isCycleScroll")), !1;
            if (o.nextAll("li").remove(), s.prevAll("li").remove(), this.scrollFn(this._dom_scrollBox, 0, 0), "prev" == i || "oldest" == i) {
                if (a.slice(0, this._currentDomList.length).join(",") == this._currentDomList.join(","))
                    return this._scrollState = "stoped", !1;
                s.before(l),
                this.scrollFn(this._dom_scrollBox, -e.length * this._liHeight, 0),
                this.scrollFn(this._dom_scrollBox, 0)
            } else {
                if (a.slice(a.length - this._currentDomList.length).join(",") == this._currentDomList.join(","))
                    return this._scrollState = "stoped", !1;
                o.after(l),
                this.scrollFn(this._dom_scrollBox, -e.length * this._liHeight)
            }
            return $('.scrollBox img[src*="res.wx.qq"]').css({
                    "vertical-align" : "middle"
                }),
            this
        },
        e.scrollNext = function (e) {
            if (!this.scrollCheck())
                return !1;
            this.setScrollType("next", e);
            var i = this.next(t.getConf("visibleNum"));
            return this.renderScroll(i, "next"),
            this
        },
        e.scrollPrev = function () {
            if (!this.scrollCheck())
                return !1;
            this.setScrollType("prev");
            var e = this.prev(t.getConf("visibleNum"));
            return this.renderScroll(e, "prev")
        },
        e.scrollNewest = function () {
            if (!this.scrollCheck())
                return !1;
            this.setScrollType("newest");
            var e = this.newest(2 * t.getConf("visibleNum"));
            return this.renderScroll(e, "newest")
        },
        e.scrollOldest = function () {
            if (!this.scrollCheck())
                return !1;
            this.setScrollType("oldest");
            var e = this.oldest(2 * t.getConf("visibleNum"));
            return this.renderScroll(e, "oldest")
        },
        e.beforeScrollStart = function () {
            return this._tmpProgressState = t.progress.state,
            this.pause()
        },
        e.pause = function () {
            return "running" == t.progress.state && $(".btnPause").trigger("click"),
            !0
        },
        e.off = function () {
            this._dom_scrollBox.hide(),
            this.pause(),
            this.pullStop()
        },
        e.on = function () {
            this._dom_scrollBox.show(),
            this.renderTotal(this._total),
            $(".messageTotal").siblings("span").text("条信息"),
            this.resume(),
            this.pull()
        },
        e.resume = function () {
            return "paused" == t.progress.state && $(".btnPause").trigger("click"),
            !0
        },
        e.afterScrollEnd = function () {
            this._scrollState = "stoped";
            var e = this._dom_scrollBox.attr("data-to") || 0,
            i = Math.abs(e) / this._liHeight;
            if (0 == i)
                var r = this._dom_scrollBox.children("li:lt(" + t.getConf("visibleNum") + ")");
            else
                var r = this._dom_scrollBox.children("li:gt(" + (i - 1) + "):lt(" + (i + t.getConf("visibleNum")) + ")");
            var s = this;
            this._currentDomList = [],
            $.each(r, function () {
                    var t = $(this);
                    s._currentDomList.push(t.attr("data-id"))
                }),
            t.pub("message.afterScrollEnd"),
            "running" == this._tmpProgressState ? this.resume() : this.pause()
        },
        e.scrollFn = function (t, e, i) {
            var r = this,
            s = "animate";
            this._transitions && (s = "translate"),
            "translate" != s && this._dom_scrollBox.height(this._dom_scrollBox.children("li").length * this._liHeight),
            t.attr("data-to", e),
            this._scrollState = "running",
            r[s](t, e, i)
        },
        e.translate = function (t, e, i) {
            if (i = "undefined" == typeof i ? this._scrollSpeed : i, 0 != i && this.beforeScrollStart() === !1)
                return !1;
            var r = this;
            return 0 == i ? t.css({
                    y : e + "px"
                }) : t.transition({
                    y : e + "px"
                }, i, function () {
                    r.afterScrollEnd()
                }),
            this
        },
        e.animate = function (t, e, i) {
            if (0 === i)
                return t.css("top", e + "px"), this;
            if (this.beforeScrollStart() === !1)
                return !1;
            var r = this;
            return i = "undefined" == typeof i ? this._scrollSpeed : i,
            t.animate({
                    top : e
                }, i, function () {
                    r.afterScrollEnd()
                }),
            this
        },
        e.bindEvent = function () {
            var e = this;
            t.sub("event.progress.compelete", function () {
                    t.DEBUG && t.log("event.progress.compelete subed in message"),
                    "message" != t.getState() || e._isInLoading || e.scrollNext("progress.compelete")
                }),
            t.sub("control.btn.btnNewest.clicked, key.right.down", function () {
                    "message" != t.getState() || e._isInLoading || ("running" == t.progress.state && t.progress.restart(), e.scrollNewest())
                }),
            t.sub("control.btn.btnOldest.clicked, key.left.down", function () {
                    "message" != t.getState() || e._isInLoading || ("running" == t.progress.state && t.progress.restart(), e.scrollOldest())
                }),
            t.sub("control.btn.btnPrev.clicked, key.up.down", function () {
                    "message" != t.getState() || e._isInLoading || ("running" == t.progress.state && t.progress.restart(), e.scrollPrev())
                }),
            t.sub("control.btn.btnNext.clicked, key.down.down", function () {
                    "message" != t.getState() || e._isInLoading || ("running" == t.progress.state && t.progress.restart(), e.scrollNext())
                }),
            t.sub("key.whitespace.down", function () {
                    var i = t.getState();
                    "message" != i && "messageDetail" != i || e._isInLoading || $(".btnPause").trigger("click")
                }),
            t.sub("message.afterScrollEnd, messageDetail.afterScrollEnd", function () {
                    for (var i = 0; i < e._laterOffWallList.length; i++)
                        if (-1 == t.inArray(e._laterOffWallList[i], e._currentDomList) && e._laterOffWallList[i] != t.messageDetail._currentId && -1 == t.inArray(e._laterOffWallList[i], e._viewIds)) {
                            if (e._linkList["delete"]("id", e._laterOffWallList[i]), e._linkListPlayed["delete"]("id", e._laterOffWallList[i]), e._tagLinkList["delete"]("id", e._laterOffWallList[i]), e._currentList.length)
                                for (var r = 0; r < e._currentList.length; r++)
                                    e._currentList[r].data.id == e._laterOffWallList[i] && (e._currentList.splice(r, 1), r--);
                            e._laterOffWallList.splice(i, 1),
                            i--
                        }
                }),
            $(".btnStar").click(function () {
                    t.pub("key.74.down")
                }),
            t.sub("key.74.down", function () {
                    return e._isInLoading ? (t.DEBUG && t.log("message._isInLoading=true, can't turnToTag"), !1) : ("message" != t.getState() && t.setState("message"), e._tag_id ? e.turnToTag(0) : e.turnToTag(1), void 0)
                })
        },
        e.turnToTag = function (e) {
            e = parseInt(e) || 0;
            var i = this;
            this.pause(),
            this.pullStop(),
            this._tag_id = e,
            this.pull(),
            this.showLoading(),
            t.subOnce("message.addCompleted", function () {
                    i._tag_id ? i._tag_loadComplete = !0 : i._loadComplete = !0,
                    i.hideLoading(function () {
                            i.initView()
                        })
                })
        }
    }
}
(wxscreen), function (t) {
    if (!t.user) {
        t.LinkList || t.throwErr("module user depend on module LinkList");
        var e = t.user = {
                _u : null,
                _m_ids : [],
                _f_ids : [],
                _o_ids : [],
                _ids : [],
                _pullTimer : null,
                _syncProgress : "stoped",
                _ajaxObj : null,
                _isReady : !1,
                _lotteryed_ids : [],
                _lotteryed_not_synced_ids : [],
                _lottery_deleted_not_synced_ids : [],
                _ddped_ids : [],
                _lottery_ids : [],
                _pre_lottery_ids : [],
                _pre_lottery_list : [],
                _ddp_ids : {
                    _m_ids : [],
                    _f_ids : []
                },
                _whitelist_user : [],
                _last_whitelist_id : ""
            };
        e.init = function () {
            this._u = new t.LinkList({
                        name : "user-" + t.getConf("companyId"),
                        storeType : "memoryStorage",
                        unique : "id"
                    }),
            this.pull(),
            this.lotteryPull(),
            this.ddpPull();
            var e = this;
            t.subOnce("user.ready user.lotterySynced user.ddpSynced", function () {
                    for (var i = 0; i < e._lotteryed_ids.length; i++)
                        t.deleteByElem(e._lotteryed_ids[i], e._lottery_ids);
                    for (var i = 0; i < e._ddped_ids.length; i++) {
                        var r = e._ddped_ids[i].user_id,
                        s = e._ddped_ids[i].to_user_id;
                        t.deleteByElem(r, e._m_ids),
                        t.deleteByElem(s, e._f_ids)
                    }
                    e._isReady = !0,
                    t.pub("user.all_ready")
                }),
            this.lotteryPollNotSynced(),
            this.lotteryShareToDom()
        },
        e.pullStop = function () {
            return clearTimeout(this._pullTimer),
            this._pullTimer = null,
            this._ajaxObj && this._ajaxObj.abort(),
            this._ajaxObj = null,
            this
        },
        e.pull = function () {
            if (!this.checkAuth())
                return !1;
            this.pullStop();
            var e = this;
            return e.sync(function (i) {
                    i && t.DEBUG && t.log("user.pull: sync return err:", i),
                    e._pullTimer = setTimeout(function () {
                                e.pull()
                            }, 5e3)
                }),
            this
        },
        e.sync = function (e) {
            if ("running" == this._syncProgress)
                return t.DEBUG && t.log("user.sync _syncProgress == running and return"), void 0;
            e = e || t.loop;
            var i,
            r = this._u.getDataByIndex(this._u.length()),
            s = 0,
            n = this;
            r && (s = r.update_time_ms);
            var o = this._last_whitelist_id;
            i = {
                last_id : s,
                last_whitelist_id : o
            },
            this._syncProgress = "running",
            this._ajaxObj = $.post(t.url("user/sync"), i, function (i) {
                        var r = null,
                        s = !1;
                        "ok" != i.info ? r = i.info : (i.user_list && (i.user_list.length ? n.add(i.user_list) : t.pub("user.ready", n)), i.whitelist_user_list.length && n.addWhitelist(i.whitelist_user_list), s = !0, t.pub("user.synced", n)),
                        n._syncProgress = "stoped",
                        t.pub("network.ok"),
                        e(r, s)
                    }, "json").error(function (i, r, s) {
                        t.DEBUG && t.log("user.sync ajax-error: jqXHR, textStatus, errorThrown ", i, r, s),
                        n._syncProgress = "stoped",
                        i.readyState < 2 && "error" == r ? t.pub("network.disconnected", i) : t.pub("network.ok"),
                        e("ajax-error:" + r)
                    })
        },
        e.add = function (e) {
            if (e instanceof Array)
                for (var i = 0; i < e.length; i++) {
                    var r = this._u.getElemByPointer(e[i].id);
                    r ? r.data.update_time_ms < e[i].update_time_ms ? (this._u["delete"]("id", e[i].id), this._u.push(e[i])) : this._u.edit({
                            id : e[i].id
                        }, e[i]) : this._u.push(e[i]),
                    1 == e[i].is_on_wall ? t.uniqueInsert(e[i].id, this._ids) : t.deleteByElem(e[i].id, this._ids),
                    t.preLoadAvatar(e[i].avatar);
                    var s = e[i].id,
                    n = parseInt(e[i].is_on_wall);
                    n ? 1 == e[i].gender ? (t.uniqueInsert(s, this._m_ids), t.deleteByElem(s, this._f_ids), t.deleteByElem(s, this._o_ids)) : 2 == e[i].gender ? (t.uniqueInsert(s, this._f_ids), t.deleteByElem(s, this._m_ids), t.deleteByElem(s, this._o_ids)) : (t.uniqueInsert(s, this._o_ids), t.deleteByElem(s, this._m_ids), t.deleteByElem(s, this._f_ids)) : (t.deleteByElem(s, this._m_ids), t.deleteByElem(s, this._f_ids), t.deleteByElem(s, this._o_ids))
                }
            else
                t.DEBUG && t.log("func user.add param list is not an Array type", e);
            return this
        },
        e.addWhitelist = function (e) {
            if (!e || !e.length)
                return t.DEBUG && t.log("user.addWhitelist failed: list empty"), void 0;
            for (var i = [], r = 0; r < e.length; r++) {
                for (var s = e[r].id, n = !1, o = 0; o < this._whitelist_user.length; o++)
                    if (s == this._whitelist_user[o].id) {
                        this._whitelist_user[o] = e[r],
                        n = !0;
                        break
                    }
                n || i.push(e[r])
            }
            return i.length && (this._whitelist_user = this._whitelist_user.concat(i)),
            this._last_whitelist_id = e[e.length - 1].update_time,
            !0
        },
        e.inWhitelist = function (t) {
            for (var e = 0; e < this._whitelist_user.length; e++)
                if (this._whitelist_user[e].user_id == t)
                    return !0;
            return !1
        },
        e.getWhitelistUserIds = function () {
            for (var t = [], e = 0; e < this._whitelist_user.length; e++)
                this._whitelist_user[e].user_id > 0 && t.push(this._whitelist_user[e].user_id);
            return t
        },
        e.length = function () {
            return this._u.length()
        },
        e.info = function (t) {
            var e = this._u.getElemByPointer(t);
            return e ? e.data : !1
        },
        e.isInTimeArr = function (e, i) {
            var r = this.info(e);
            if (!r)
                return !1;
            var s = "0000-00-00 00:00:00" != r.on_wall_time ? r.on_wall_time : r.add_time;
            return s = Date.parse(t._generateDateStr(s)),
            s >= i[0] && s <= i[1] ? !0 : !1
        },
        e.random = function () {
            var e = this._ids.length - 1;
            if (0 > e)
                return !1;
            randId = this._ids[t.rand(0, e)];
            var i = this.info(randId);
            return i ? i : !1
        },
        e._lotteryPullTimer = null,
        e._lotteryPullNotSyncTimer = null,
        e._lotteryShareToDomTimer = null,
        e._lotteryPullAjaxObj = null,
        e.lotteryInitUser = function () {
            var e = t.parseVisibleTime("lottery");
            this._lottery_ids = [];
            for (var i = 0; i < this._ids.length; i++)
                this.isInTimeArr(this._ids[i], e) && -1 == t.inArray(this._ids[i], this._lotteryed_ids) && t.uniqueInsert(this._ids[i], this._lottery_ids);
            return !0
        },
        e.lotteryPullStop = function () {
            return clearTimeout(this._lotteryPullTimer),
            this._lotteryPullAjaxObj && (this._lotteryPullAjaxObj.abort(), this._lotteryPullAjaxObj = null),
            this
        },
        e.lotteryPull = function () {
            var e = this;
            return this.lotteryPullStop(),
            this.checkAuth("lotteryPlug") ? t.getConf("isDemo") ? (this._lotteryPullTimer = setTimeout(function () {
                            e.lotteryInitUser(),
                            t.pub("user.lotterySynced")
                        }, 1e3), !1) : (e.lotterySync(function () {
                        "lottery" == t.getState() && (e._lotteryPullTimer = setTimeout(function () {
                                        e.lotteryPull()
                                    }, 1e3 * t.rand(7, 10)))
                    }), void 0) : (this._lotteryPullTimer = setTimeout(function () {
                            e.lotteryInitUser(),
                            t.pub("user.lotterySynced")
                        }, 1e3), !1)
        },
        e.lotterySync = function (e) {
            e = e || t.loop;
            var i = this;
            i._lotteryPullAjaxObj = $.post(t.url("lottery/sync"), function (r) {
                        var s = null,
                        n = null;
                        "ok" == r.info ? (i._lottery_deleted_not_synced_ids.length || i._lotteryed_not_synced_ids.length || (i._lotteryed_ids = r.ids), i._pre_lottery_ids = r.pre_ids, i._pre_lottery_list = r.pre_list, s = !0, i.lotteryInitUser(), t.pub("user.lotterySynced", i)) : n = r.info,
                        e(n, s)
                    }, "json").error(function (i, r) {
                        i.readyState < 2 && "error" == r && t.pub("network.disconnected", i),
                        e("user.lotterySync: ajax-error")
                    })
        },
        e.lotteryGetIds = function () {
            for (var e = [], i = 0; i < this._lottery_ids.length; i++) {
                var r = this._lottery_ids[i];
                this._whitelist_user.length && this.inWhitelist(r) && -1 == t.inArray(r, this._pre_lottery_ids) && -1 == t.inArray(r, this._lottery_deleted_not_synced_ids) ? e.push(r) : this._whitelist_user.length || -1 != t.inArray(r, this._pre_lottery_ids) || -1 != t.inArray(r, this._lottery_deleted_not_synced_ids) || e.push(r)
            }
            return e
        },
        e.lotteryGetIdsLength = function () {
            var t = this.lotteryGetIds();
            return t.length
        },
        e.lotteryRandom = function () {
            var e = this._lottery_ids.length - 1;
            if (0 > e)
                return !1;
            var i,
            r,
            s = this._lotteryed_ids.length;
            if (this._pre_lottery_list && this._pre_lottery_list.length)
                for (var n = 0; n < this._pre_lottery_list.length; n++)
                    if (r = this._pre_lottery_list[n], (r.rank == s + 1 || 0 == parseInt(r.rank)) && -1 == t.inArray(r.user_id, this._lotteryed_ids)) {
                        i = parseInt(r.user_id);
                        break
                    }
            if (!i) {
                for (var o = [], n = 0; n < this._lottery_ids.length; n++) {
                    var l = this._lottery_ids[n];
                    this._whitelist_user.length && this.inWhitelist(l) && -1 == t.inArray(l, this._pre_lottery_ids) && -1 == t.inArray(l, this._lottery_deleted_not_synced_ids) ? o.push(l) : this._whitelist_user.length || -1 != t.inArray(l, this._pre_lottery_ids) || -1 != t.inArray(l, this._lottery_deleted_not_synced_ids) || o.push(l)
                }
                if (!o.length)
                    return t.DEBUG && t.log("user.lotteryRandom failed: lottery_ids empty"), !1;
                i = o[t.rand(0, o.length - 1)]
            }
            var a = this.info(i);
            return a || t.throwErr("user.lotteryRandom getElemByPointer failed uid=", i),
            a
        },
        e.lotterySave = function (e, i) {
            if (i = i || t.loop, !e || -1 == t.inArray(e, this._lottery_ids))
                return i("没有在大屏幕中找到此用户"), void 0;
            if (t.inArray(e, this._lotteryed_ids) > -1)
                return i("保存失败，此用户已经中奖"), void 0;
            var r = this,
            s = function () {
                t.uniqueInsert(e, r._lotteryed_ids),
                t.deleteByElem(e, r._lottery_ids),
                i(null, !0)
            };
            return t.getConf("isDemo") ? (s(), void 0) : (t.uniqueInsert(e, r._lotteryed_not_synced_ids), $.ajax({
                        type : "POST",
                        url : t.url("lottery/lottery_save"),
                        data : {
                            user : e
                        },
                        dataType : "json",
                        timeout : 1e4,
                        success : function (i) {
                            "ok" == i.info && t.deleteByElem(e, r._lotteryed_not_synced_ids)
                        },
                        error : function (e, i) {
                            e.readyState < 2 && "error" == i && t.pub("network.disconnected", e)
                        }
                    }), setTimeout(function () {
                        s()
                    }, 10), void 0)
        },
        e.lotteryDelete = function (e, i) {
            var r = this,
            s = function () {
                t.deleteByElem(e, r._lotteryed_ids),
                t.deleteByElem(e, r._lotteryed_not_synced_ids),
                t.uniqueInsert(e, r._lottery_ids),
                i(null, !0)
            };
            return t.getConf("isDemo") ? (s(), void 0) : (t.uniqueInsert(e, r._lottery_deleted_not_synced_ids), $.post(t.url("lottery/del_win_user"), {
                        id : e
                    }, function (i) {
                        "ok" == i.info && t.deleteByElem(e, r._lottery_deleted_not_synced_ids),
                        s()
                    }, "json").error(function (e, i) {
                        e.readyState < 2 && "error" == i && t.pub("network.disconnected", e)
                    }), setTimeout(function () {
                        s()
                    }, 10), void 0)
        },
        e.lotteryReset = function (e) {
            e = e || t.loop;
            var i = this,
            r = function () {
                i._lotteryed_ids = [],
                i._lotteryed_not_synced_ids = [],
                i.lotteryInitUser(),
                e(null, !0)
            };
            return t.getConf("isDemo") ? (r(), void 0) : ($.post(t.url("lottery/lottery_reset"), function (e) {
                        if ("ok" != e.info)
                            for (var s = 0; s < i._lotteryed_ids.length; s++)
                                t.uniqueInsert(i._lotteryed_ids[s], i._lottery_deleted_not_synced_ids);
                        r()
                    }, "json").error(function (e, s) {
                        for (var n = 0; n < i._lotteryed_ids.length; n++)
                            t.uniqueInsert(i._lotteryed_ids[n], i._lottery_deleted_not_synced_ids);
                        r(),
                        e.readyState < 2 && "error" == s && t.pub("network.disconnected", e)
                    }), void 0)
        },
        e.lotteryPollNotSynced = function () {
            var e = this;
            clearInterval(this._lotteryPullNotSyncTimer),
            this._lotteryPullNotSyncTimer = setInterval(function () {
                        if (e._lotteryed_not_synced_ids.length || e._lottery_deleted_not_synced_ids.length) {
                            var i = e._lottery_deleted_not_synced_ids.concat(),
                            r = e._lotteryed_not_synced_ids.concat();
                            $.post(t.url("lottery/lottery_not_synced"), {
                                    deleted : i.join(","),
                                    lotteryed : r.join(",")
                                }, function (s) {
                                    if ("ok" == s.info) {
                                        for (var n = 0; n < i.length; n++)
                                            t.deleteByElem(i[n], e._lottery_deleted_not_synced_ids);
                                        for (var n = 0; n < r.length; n++)
                                            t.deleteByElem(r[n], e._lotteryed_not_synced_ids)
                                    } else
                                        t.DEBUG && t.log("user.lotteryPollNotSynced failed:", s)
                                }, "json").error(function (e, i) {
                                    t.DEBUG && t.log("user.lotteryPollNotSynced failed: ajax-error"),
                                    e.readyState < 2 && "error" == i && t.pub("network.disconnected", e)
                                })
                        }
                    }, 7e3)
        },
        e.lotteryShareToDom = function () {
            if (!window.JSON)
                return t.DEBUG && t.log("user.lotteryShareToDom failed: window.JSON is undefined"), void 0;
            clearInterval(this._lotteryShareToDomTimer);
            var e = this;
            this._lotteryShareToDomTimer = setInterval(function () {
                        for (var i, r = [], s = 0; s < e._lotteryed_ids.length; s++) {
                            var n = e.info(e._lotteryed_ids[s]);
                            r.push(n)
                        }
                        var i = JSON.stringify({
                                    data : r,
                                    companyId : t.getConf("domain")
                                });
                        $("#lotteryDataJsonBox").length || $("body").append('<div id="lotteryDataJsonBox" style="display:none;"></div>'),
                        $("#lotteryDataJsonBox").text(i)
                    }, 2e3)
        },
        e._ddpPullTimer = null,
        e._ddpPullAjaxObj = null,
        e.ddpInitUser = function () {
            var e = t.parseVisibleTime("ddp");
            this._ddp_ids = {
                _m_ids : [],
                _f_ids : []
            };
            var i;
            for (i = 0; i < this._m_ids.length; i++)
                this.isInTimeArr(this._m_ids[i], e) && -1 == this.inDdp(this._m_ids[i]) && t.uniqueInsert(this._m_ids[i], this._ddp_ids._m_ids);
            for (i = 0; i < this._f_ids.length; i++)
                this.isInTimeArr(this._f_ids[i], e) && -1 == this.inDdp(this._f_ids[i]) && t.uniqueInsert(this._f_ids[i], this._ddp_ids._f_ids);
            return !0
        },
        e.ddpPullStop = function () {
            return clearTimeout(this._ddpPullTimer),
            this._ddpPullAjaxObj && (this._ddpPullAjaxObj.abort(), this._ddpPullAjaxObj = null),
            this
        },
        e.ddpPull = function () {
            var e = this;
            if (this.ddpPullStop(), !this.checkAuth("ddpPlug"))
                return this._ddpPullTimer = setTimeout(function () {
                            e.ddpInitUser(),
                            t.pub("user.ddpSynced")
                        }, 1e3), void 0;
            if (t.getConf("isDemo"))
                return this._ddpPullTimer = setTimeout(function () {
                            e.ddpInitUser(),
                            t.pub("user.ddpSynced")
                        }, 1e3), !1;
            var e = this;
            e.ddpSync(function () {
                    "ddp" == t.getState() && (e._ddpPullTimer = setTimeout(function () {
                                    e.ddpPull()
                                }, 1e3 * t.rand(5, 9)))
                })
        },
        e.ddpSync = function (e) {
            e = e || t.loop;
            var i = this;
            i._ddpPullAjaxObj = $.post(t.url("ddp/sync"), function (r) {
                        var s = null,
                        n = null;
                        "ok" == r.info ? (i._ddped_ids = r.ids, s = !0, i.ddpInitUser(), t.pub("user.ddpSynced", i)) : n = r.info,
                        e(n, s)
                    }, "json").error(function (i, r) {
                        i.readyState < 2 && "error" == r && t.pub("network.disconnected", i),
                        e("user.ddpSync: ajax-error")
                    })
        },
        e.ddpRandom = function (e) {
            if (!this._ddp_ids._m_ids.length || !this._ddp_ids._f_ids.length)
                return !1;
            if ("m" == e) {
                if (!this._ddp_ids._m_ids.length)
                    return !1;
                var i = this._ddp_ids._m_ids[t.rand(0, this._ddp_ids._m_ids.length - 1)];
                return this.info(i)
            }
            if ("f" == e) {
                if (!this._ddp_ids._f_ids.length)
                    return !1;
                var r = this._ddp_ids._f_ids[t.rand(0, this._ddp_ids._f_ids.length - 1)];
                return this.info(r)
            }
            if ("all" == e) {
                var s = this.ddpRandom("m");
                if (!s)
                    return !1;
                var n = this.ddpRandom("f");
                return n ? {
                    user : s,
                    to_user : n
                }
                 : !1
            }
            return !1
        },
        e.ddpSave = function (e, i, r) {
            if (r = r || t.loop, !e || !i)
                return r("ddpSave: id or to_id is not exists"), void 0;
            var s = this.ddpInfo(e) || this.ddpInfo(i);
            if (s && s.user_id > 0 && s.to_user_id > 0)
                return r("ddpSave: id or to_id is in ddp list"), void 0;
            var n = this.info(e),
            o = this.info(i),
            l = {
                id : 0,
                user_id : e,
                name : n.name,
                avatar : n.avatar,
                to_user_id : i,
                to_name : o.name,
                to_avatar : o.avatar
            },
            a = this,
            d = function (s) {
                var n = a.ddpInfo(e) || a.ddpInfo(i);
                n ? (n.user_id = l.user_id, n.name = l.name, n.avatar = l.avatar, n.to_user_id = l.to_user_id, n.to_name = l.to_name, n.to_avatar = l.to_avatar) : (l.id = s, a._ddped_ids.push(l)),
                t.deleteByElem(l.user_id, a._ddp_ids._m_ids),
                t.deleteByElem(l.to_user_id, a._ddp_ids._f_ids),
                r(null, n || l)
            };
            return t.getConf("isDemo") ? (d(t.cid()), void 0) : ($.post(t.url("ddp/save"), {
                        user : e,
                        to_user : i
                    }, function (s) {
                        return s && "object" == typeof s && s.info ? ("ok" == s.info ? d(s.matched_info.id) : r(s.info), void 0) : (t.counter("user_ddpsave") < 2 ? a.ddpSave(e, i, r) : (t.counter("user_ddpsave", "reset"), r("ddpsave: the wxscreen server not response")), void 0)
                    }, "json").error(function (e, i) {
                        e.readyState < 2 && "error" == i && t.pub("network.disconnected", e),
                        r("user.ddpSave: ajax-error")
                    }), void 0)
        },
        e.ddpDelete = function (e, i, r) {
            if (isNaN(e) || isNaN(i))
                return r("ddpDelete: arguments is empty");
            var s = this.ddpInfo(e) || this.ddpInfo(i);
            if (!s)
                return r("ddpInfo not found");
            var n = e ? e : i,
            o = this.inDdp(n),
            l = this,
            a = function () {
                e > 0 && i > 0 ? (l._ddped_ids.splice(o, 1), t.uniqueInsert(e, l._ddp_ids._m_ids), t.uniqueInsert(i, l._ddp_ids._f_ids), s.user_id = 0, s.to_user_id = 0) : e ? (s.user_id = 0, t.uniqueInsert(e, l._ddp_ids._m_ids)) : i && (s.to_user_id = 0, t.uniqueInsert(i, l._ddp_ids._f_ids)),
                r(null, s)
            };
            return t.getConf("isDemo") ? (a(), void 0) : ($.post(t.url("ddp/del_user"), {
                        id : e,
                        to_id : i
                    }, function (s) {
                        return s && "object" == typeof s && s.info ? ("ok" == s.info ? a() : r(s.info), void 0) : (t.counter("user_ddpdelete") < 2 ? l.ddpDelete(e, i, r) : (t.counter("user_ddpdelete", "reset"), r("the wxscreen server not response")), void 0)
                    }, "json").error(function (e, i) {
                        e.readyState < 2 && "error" == i && t.pub("network.disconnected", e),
                        r("user.ddpDelete: ajax-error")
                    }), void 0)
        },
        e.ddpReset = function (e) {
            e = e || t.loop;
            var i = this,
            r = function () {
                i._ddped_ids = [],
                i.ddpInitUser(),
                e(null, !0)
            };
            return t.getConf("isDemo") ? (r(), void 0) : ($.post(t.url("ddp/reset"), function (s) {
                        return s && "object" == typeof s && s.info ? ("ok" == s.info ? r() : e(s.info), void 0) : (t.counter("user_ddpreset") < 2 ? i.ddpReset(e) : (t.counter("user_ddpreset", "reset"), e("ddpreset: the wxscreen server not response")), void 0)
                    }, "json").error(function (i, r) {
                        i.readyState < 2 && "error" == r && t.pub("network.disconnected", i),
                        e("ddpReset: ajax-error")
                    }), void 0)
        },
        e.inDdp = function (t) {
            for (var e, i = -1, r = 0; r < this._ddped_ids.length; r++)
                if (e = this._ddped_ids[r], e.user_id == t || e.to_user_id == t) {
                    i = r;
                    break
                }
            return i
        },
        e.ddpInfo = function (t) {
            if (!t)
                return !1;
            var e = this.inDdp(t);
            return 0 > e ? !1 : this._ddped_ids[e]
        },
        e.checkAuth = function (e) {
            return e && !t.getConf(e) ? !1 : t.isAdmin() || t.getConf("isDemo") ? !0 : !1
        }
    }
}
(wxscreen), function (t) {
    if (!t.moving) {
        var e = t.moving = {
                effects : {}
                
            };
        e.show = function (e, i) {
            this.effects[e] || t.throwErr("moving.show: movieName is empty"),
            this.effects[e].show(i)
        },
        e.hide = function (e, i) {
            this.effects[e] || t.throwErr("moving.hide: movieName is empty"),
            this.effects[e].hide(i)
        }
    }
}
(wxscreen), function (t) {
    function e(e) {
        var n = o[e],
        l = Math.random() < .5 ? "clockwiseSpin" : "counterclockwiseSpinAndFlip",
        a = s(i(0, 5)),
        d = s(i(n.fadeAndDropDuration[0], n.fadeAndDropDuration[1])),
        h = s(i(n.spinDuration[0], n.spinDuration[1])),
        u = "auto";
        n.sizeScale && (u = t.rand(n.sizeScale[0], n.sizeScale[1]) + "px");
        var _ = t.getConf("siteUrl") + "/images/moving/" + e + t.rand(1, n.imageNum) + ".png",
        c = ["width:" + u, "-webkit-animation-name:" + l, "-webkit-animation-duration:" + h];
        c = c.join(";");
        var f = ["top:-180px", "left: " + r(t.rand(-180, document.body.clientWidth)), "-webkit-animation-name:fade, drop", "-webkit-animation-duration:" + d + ", " + d, "-webkit-animation-delay:" + a + ", " + a];
        return f = f.join(";"),
        '<span class="moving-child" style="' + f + '"><img src="' + _ + '" style="' + c + '" /></span>'
    }
    function i(t, e) {
        return t + Math.random() * (e - t)
    }
    function r(t) {
        return t + "px"
    }
    function s(t) {
        return t + "s"
    }
    if (t.moving || t.throwErr("falling depend on g.moving"), t.moving.effects.falling)
        return !1;
    var n = t.moving.effects.falling = {},
    o = {
        rose : {
            id : "moving_fallingRose",
            num : 100,
            imageNum : 2,
            sizeScale : [50, 80],
            fadeAndDropDuration : [3, 7],
            spinDuration : [1, 5]
        },
        snow : {
            id : "moving_fallingSnow",
            num : 100,
            imageNum : 5,
            fadeAndDropDuration : [3, 7],
            spinDuration : [1, 5]
        }
    };
    n.show = function (i) {
        var r = i.effectName;
        r || t.throwErr("falling.show: effectName is empty"),
        o[r] || t.throwErr("falling.show: effect not found"),
        o[r] = $.extend(o[r], i);
        var s = $("#" + o[r].id);
        if (s.length || ($("body").append('<div id="' + o[r].id + '" style="position:absolute;top:0;left:0;width:100%;height: ' + $(document).height() + 'px;overflow:hidden;"></div>'), s = $("#" + o[r].id)), s.children().length)
            return s.show(), !0;
        for (var n = "", l = 0; l < o[r].num; l++)
            n += e(r);
        return s.html(n),
        !0
    },
    n.hide = function (t) {
        return o[t] && $("#" + o[t].id).hide(),
        !0
    }
}
(wxscreen);
 