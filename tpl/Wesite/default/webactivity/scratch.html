
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta content="微盟、微信营销、微信代运营、微信定制开发、微信托管、微网站、微商城、微营销" name="Keywords">
    <meta content="微盟，国内最大的微信公众智能服务平台，微盟八大微体系：微菜单、微官网、微会员、微活动、微商城、微推送、微服务、微统计，企业微营销必备。" name="Description">
    <link rel="stylesheet" type="text/css" href="http://stc.weimob.com/css/web_bb/activity_style.css?2014-03-07-1" media="all" />
    <script type="text/javascript" src="http://stc.weimob.com/src/web_bb/zepto.js?2014-03-07-1"></script>
    <script type="text/javascript" src="http://stc.weimob.com/src//web_bb/alert.js?2014-03-07-1"></script>
    <title>刮刮卡</title>
    <link rel="shortcut icon" href="http://stc.weimob.com/img/favicon.ico" />
    <!--[if lte IE 9]><script src="http://stc.weimob.com/src/watermark.js"></script><![endif]-->
    <!--[if IE 7]><link href="http://stc.weimob.com/css/font_awesome_ie7.css" rel="stylesheet" /><![endif]-->
</head>
<body>
<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content=" initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no">
    <meta name="description" content="刮刮卡">
    <title>刮刮卡</title>
    <script src="http://stc.weimob.com/src/jquery.min.js"></script>
    <script type="text/javascript">
        function loading(canvas, options) {
            this.canvas = canvas;
            if (options) {
                this.radius = options.radius || 12;
                this.circleLineWidth = options.circleLineWidth || 4;
                this.circleColor = options.circleColor || 'lightgray';
                this.moveArcColor = options.moveArcColor || 'gray';
            } else {
                this.radius = 12;
                this.circelLineWidth = 4;
                this.circleColor = 'lightgray';
                this.moveArcColor = 'gray';
            }
        }
        loading.prototype = {
            show: function () {
                var canvas = this.canvas;
                if (!canvas.getContext) return;
                if (canvas.__loading) return;
                canvas.__loading = this;
                var ctx = canvas.getContext('2d');
                var radius = this.radius;
                var me = this;
                var rotatorAngle = Math.PI * 1.5;
                var step = Math.PI / 6;
                canvas.loadingInterval = setInterval(function () {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    var lineWidth = me.circleLineWidth;
                    var center = { x: canvas.width / 2, y: canvas.height / 2 };

                    ctx.beginPath();
                    ctx.lineWidth = lineWidth;
                    ctx.strokeStyle = me.circleColor;
                    ctx.arc(center.x, center.y + 20, radius, 0, Math.PI * 2);
                    ctx.closePath();
                    ctx.stroke();
                    //在圆圈上面画小圆   
                    ctx.beginPath();
                    ctx.strokeStyle = me.moveArcColor;
                    ctx.arc(center.x, center.y + 20, radius, rotatorAngle, rotatorAngle + Math.PI * .45);
                    ctx.stroke();
                    rotatorAngle += step;

                }, 100);
            },
            hide: function () {
                var canvas = this.canvas;
                canvas.__loading = false;
                if (canvas.loadingInterval) {
                    window.clearInterval(canvas.loadingInterval);
                }
                var ctx = canvas.getContext('2d');
                if (ctx) ctx.clearRect(0, 0, canvas.width, canvas.height);
            }
        };
    </script>
</head>
<body data-role="page" class="activity-scratch-card-winning">

<script src="http://stc.weimob.com/src/web_bb/wScratchPad.js"></script>
<div class="main">
    <div class="cover">
        <img src="http://stc.weimob.com/img/web_bb/activity/activity-scratch-card-bannerbg.png">
        <div id="prize">你已刮过1次</div>        </div>

    <div class="content">

        <div id="zjl" style="display: none" class="boxcontent boxwhite">
            <div class="box">
                <div class="title-red"><span>恭喜你中奖了</span></div>
                <div class="Detail">
                    <p>你中了：<span class="red"></span></p>
                    <p>兑奖SN码：<span class="red" id="sncode"></span></p>
                    <p class="red">兑换奖品请阅读活动说明或联系相关工作人员确认兑换！兑奖请联系我们，电话13899999999</p>
                    <p>
                        <input name="" class="px" id="tel" value="" type="text" placeholder="用户请输入您的手机号">
                    </p>
                    <p>
                    <p>
                        <input class="pxbtn" name="提 交" id="save-btn" type="button" value="用户提交">
                    </p>
                </div>
                <!--  <div class="Detail">
                      <p>你中了：<span class="red">一等奖</span></p>
                      <p>兑奖SN码：<span class="red" id="Span1">080731995610087932</span></p>
                      <p class="red">请在下方提交你的手机号，方便我们联系你兑奖!兑奖请联系我们，电话18950099999</p>

                      <p class="red">中奖者手机号：144444 </p>
                      <p>
                  </div>-->
            </div>

        </div>

        <div class="boxcontent boxwhite">
            <div class="box">
                <div class="title-red"><span>奖项设置：</span></div>
                <div class="Detail">
                    <p>gg1： 22。数量：10</p>                                                                                                                                            </div>
            </div>
        </div>
        <div class="boxcontent boxwhite">
            <div class="box">
                <div class="title-red">活动说明：</div>
                <div class="Detail">
                    <p class="red">本次活动总共可以刮1次,你已经刮了1次,机会如果没用完重新进入本页面可以再刮! 如果已中奖，则不可再刮！</p>
                    <p>亲，请点击进入刮刮奖活动页面，祝您好运哦！  </p>
                </div>
            </div>
        </div>
    </div>
    <div style="clear: both;"></div>
</div>
<script src="http://stc.weimob.com/src/web_bb/alert.js"></script>

<script type="text/javascript">
    //window.sncode = "null啊";
    //window.prize = "谢谢参与呵呵";

    var zjl =false;//没中奖为false中奖为true
    var num = 0;
    var goon = true;
    $(function () {
        var useragent = window.navigator.userAgent.toLowerCase();
        $("#scratchpad").wScratchPad({
            width: 150,
            height: 40,
            color: "#a9a9a7",
            scratchMove: function () {
                num++;
                if (num == 2) {
                    document.getElementById('prize').innerHTML = "谢谢参与";
                }
                if (zjl && num > 5 && goon) {
                    //$("#zjl").fadeIn();
                    goon = false;
                    $("#zjl").slideToggle(500);
                    //$("#outercont").slideUp(500)
                }
                if (useragent.indexOf("android 4") > 0) {
                    if ($("#scratchpad").css("color").indexOf("51") > 0) {
                        $("#scratchpad").css("color", "rgb(50,50,50)");
                    } else if ($("#scratchpad").css("color").indexOf("50") > 0) {
                        $("#scratchpad").css("color", "rgb(51,51,51)");
                    }
                }

            }
        });

        //$("#prize").html("谢谢参与");
        //loadingObj.hide();
        //$(".loading-mask").remove();
    });

    $("#save-btn").bind("click",
            function () {
                var btn = $(this);
                var tel = $("#tel").val();
                if (tel == '') {
                    alert("请输入手机号");
                    return
                }

                var submitData = {
                    id: 27362,
                    code: $("#sncode").text(),
                    tel: tel,
                    tel_rename:'手机号',
                    sdid: 253934,
                    fromUsername:'001',
                    tk:'4a12207616277f4cc516383a02e07870'
                };
                $.post('/activity/AddCard', submitData,
                        function (data) {
                            if (data.success == true) {
                                alert(data.msg);
                                return
                            } else { }
                        },
                        "json")
            });

    $("#save-btnn").bind("click",
            function () {
                //var btn = $(this);
                var submitData = {
                    id: 27362,
                    code: $("#sncode").text(),
                    sdid: 253934,
                    parssword: $("#parssword").val(),
                    Confirm_pwd : '',
                    fromUsername:'001',
                    tk:'4a12207616277f4cc516383a02e07870'
                };
                $.post('/activity/AddCard', submitData,
                        function (data) {
                            if (data.success == true) {
                                alert(data.msg);
                                if (data.changed == true) {
                                    window.location.href = location.href;
                                }
                                return
                            } else { }
                        },
                        "json")
            });
    document.addEventListener('WeixinJSBridgeReady', function onBridgeReady() {
        window.shareData = {
            "imgUrl": "http://stc.weimob.com/img/web_bb/activity/activity-scratch-card-start.jpg",
            "timeLineLink": "http://www.weimob.com/activity/ScratchCard?id=27362&bid=253934&pid=124547&wechatid=fromUsername&v=4a12207616277f4cc516383a02e07870",
            "sendFriendLink": "http://www.weimob.com/activity/ScratchCard?id=27362&bid=253934&pid=124547&wechatid=fromUsername&v=4a12207616277f4cc516383a02e07870",
            "weiboLink": "http://www.weimob.com/activity/ScratchCard?id=27362&bid=253934&pid=124547&wechatid=fromUsername&v=4a12207616277f4cc516383a02e07870",
            "tTitle": "刮刮卡活动开始了",
            "tContent": "亲，请点击进入刮刮卡页面，快来参加活动吧！~",
            "fTitle": "刮刮卡活动开始了",
            "fContent": "亲，请点击进入刮刮卡页面，快来参加活动吧！~",
            "wContent": "亲，请点击进入刮刮卡页面，快来参加活动吧！~"
        };
        // 发送给好友
        WeixinJSBridge.on('menu:share:appmessage', function (argv) {
            WeixinJSBridge.invoke('sendAppMessage', {
                "img_url": window.shareData.imgUrl,
                "img_width": "640",
                "img_height": "640",
                "link": window.shareData.sendFriendLink,
                "desc": window.shareData.fContent,
                "title": window.shareData.fTitle
            }, function (res) {
                _report('send_msg', res.err_msg);
            })
        });

        // 分享到朋友圈
        WeixinJSBridge.on('menu:share:timeline', function (argv) {
            WeixinJSBridge.invoke('shareTimeline', {
                "img_url": window.shareData.imgUrl,
                "img_width": "640",
                "img_height": "640",
                "link": window.shareData.timeLineLink,
                "desc": window.shareData.tContent,
                "title": window.shareData.tTitle
            }, function (res) {
                _report('timeline', res.err_msg);
            });
        });

        // 分享到微博
        WeixinJSBridge.on('menu:share:weibo', function (argv) {
            WeixinJSBridge.invoke('shareWeibo', {
                "content": window.shareData.wContent,
                "url": window.shareData.weiboLink,
            }, function (res) {
                _report('weibo', res.err_msg);
            });
        });
    }, false)
</script>
<footer style="text-align:center; color:#ffd800;margin-right:20px"><a href="/weisite/home?pid=124547&bid=253934&wechatid=001&wxref=mp.weixin.qq.com">©big012</a></footer>
</body>
</html>
</body>
<script type="text/javascript">
    (function() {
        var wtj = document.createElement('script'); wtj.type = 'text/javascript'; wtj.async = true;
        wtj.src = 'http://tj.weimob.com/wtj.js?url=' + encodeURIComponent(location.href);
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(wtj, s);
    })();
    var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
    document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fd80741dd59de91e1846b2add2c0ad2a2' type='text/javascript'%3E%3C/script%3E"));
    function weimobAfterShare(shareFromWechatId,sendFriendLink,shareToPlatform){
        var wmShare = document.createElement('script'); wmShare.type = 'text/javascript'; wmShare.async = true;
        wmShare.src = 'http://tj.weimob.com/api-share.js?fromWechatId=' + shareFromWechatId + '&shareToPlatform=';
        wmShare.src += shareToPlatform + '&pid=124547&sendFriendLink=' + encodeURIComponent(sendFriendLink);
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(wmShare, s);
    }

    /**
     * 默认分享出去的数据
     *
     */
    function getShareImageUrl(){
        var share_imgurl = "";
        if("" == share_imgurl){
            var shareImgObj = document.getElementsByClassName("shareImgUrl")[0];
            if('undefined' != typeof(shareImgObj)){
                share_imgurl = shareImgObj.src;
            }
        }
        return window.shareData.imgUrl || share_imgurl;
    }

    window.shareData = window.shareData || {
        "timeLineLink": "http://www.weimob.com/activity/ScratchCard?id=27362&bid=253934&wechatid=fromUsername&pid=124547&v=4a12207616277f4cc516383a02e07870",
        "sendFriendLink": "http://www.weimob.com/activity/ScratchCard?id=27362&bid=253934&wechatid=fromUsername&pid=124547&v=4a12207616277f4cc516383a02e07870",
        "weiboLink": "http://www.weimob.com/activity/ScratchCard?id=27362&bid=253934&wechatid=fromUsername&pid=124547&v=4a12207616277f4cc516383a02e07870",
        "tTitle": document.title,
        "tContent": document.title,
        "fTitle": document.title,
        "fContent": document.title,
        "wContent": document.title
    }
    document.addEventListener('WeixinJSBridgeReady', function onBridgeReady() {
        // 发送给好友
        WeixinJSBridge.on('menu:share:appmessage', function (argv) {
            WeixinJSBridge.invoke('sendAppMessage', {
                "img_url": getShareImageUrl(),
                "img_width": "640",
                "img_height": "640",
                "link": window.shareData.sendFriendLink,
                "desc": window.shareData.fContent,
                "title": window.shareData.fTitle
            }, function (res) {
                weimobAfterShare("001",window.shareData.sendFriendLink,'appmessage');
                _report('send_msg', res.err_msg);
            })
        });

        // 分享到朋友圈
        WeixinJSBridge.on('menu:share:timeline', function (argv) {
            WeixinJSBridge.invoke('shareTimeline', {
                "img_url": getShareImageUrl(),
                "img_width": "640",
                "img_height": "640",
                "link": window.shareData.timeLineLink,
                "desc": window.shareData.tContent,
                "title": window.shareData.tTitle
            }, function (res) {
                weimobAfterShare("001",window.shareData.timeLineLink,'timeline');
                _report('timeline', res.err_msg);
            });
        });

        // 分享到微博
        WeixinJSBridge.on('menu:share:weibo', function (argv) {
            WeixinJSBridge.invoke('shareWeibo', {
                "content": window.shareData.wContent,
                "url": window.shareData.weiboLink
            }, function (res) {
                weimobAfterShare("001",window.shareData.weiboLink,'weibo');
                _report('weibo', res.err_msg);
            });
        });
    }, false);
</script>
<script type="text/javascript" src="http://kf.weimob.com/js/ChatFloat.js"></script>
<script type="text/javascript">
    var str_domain = location.href.split('/',4)[2];
    var boolIsTest = true;
    if(str_domain == 'www.weimob.com'){
        boolIsTest = false;
    }
    new ChatFloat({
        AId: '124547',
        openid: "001",
        top:150,
        right:0,
        IsTest:boolIsTest
    });
</script>
</html>